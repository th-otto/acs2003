		.text

	.globl ed_abort
ed_abort:
		movea.l    ACSblk,a0
		movea.l    600(a0),a0
		jsr        ed_wabort
		rts

ed_wabort:
		movem.l    d3/a2-a4,-(a7)
		movea.l    a0,a2
		movea.l    ACSblk,a1
		cmpa.l     576(a1),a0
		bne.s      ed_wabort_1
		jsr        Adr_unselect
ed_wabort_1:
		jsr        Awi_diaend
		movea.l    (a2),a3
		andi.w     #0xFFFE,84(a2)
		moveq.l    #-1,d0
		move.w     d0,30(a2)
		move.w     d0,28(a2)
		movea.l    20(a2),a0
		movea.l    34(a3),a1
		jsr        (a1)
		clr.l      20(a2)
		move.l     38(a3),d0
		beq.s      ed_wabort_2
		movea.l    74(a2),a0
		jsr        Ast_delete
		move.l     38(a3),74(a2)
		move.w     32(a2),d0
		ble.s      ed_wabort_2
		clr.w      -(a7)
		clr.w      -(a7)
		move.l     74(a2),-(a7)
		moveq.l    #2,d1
		jsr        wind_set
		addq.w     #8,a7
ed_wabort_2:
		movea.l    154(a2),a0
		jsr        Ast_isEmpty
		tst.w      d0
		bne.s      ed_wabort_3
		movea.l    154(a2),a0
		jsr        Ast_delete
ed_wabort_3:
		move.l     42(a3),154(a2)
		movea.l    158(a2),a0
		jsr        Ast_isEmpty
		tst.w      d0
		bne.s      ed_wabort_4
		movea.l    158(a2),a0
		jsr        Ast_delete
ed_wabort_4:
		move.l     46(a3),158(a2)
		move.w     86(a2),d0
		and.w      #0x0100,d0
		bne        ed_wabort_5
		move.w     16(a3),36(a2)
		move.w     18(a3),38(a2)
		move.w     20(a3),40(a2)
		move.w     22(a3),42(a2)
		movea.l    WI_OBJECT+94,a0
		jsr        Aob_create
		movea.l    a0,a4
		move.l     a0,94(a2)
		move.l     a4,d0
		beq.s      ed_wabort_6
		movea.l    a4,a0
		jsr        Aob_fix
		movea.l    a4,a0
		jsr        Ame_namefix
ed_wabort_6:
		movea.l    a2,a0
		movea.l    16(a2),a1
		jsr        (a1)
		movea.l    20(a2),a0
		move.w     12(a3),16(a0)
		movea.l    20(a2),a0
		move.w     14(a3),18(a0)
		move.w     34(a2),d0
		and.w      #0x0100,d0
		beq.s      ed_wabort_7
		move.w     34(a2),d1
		and.w      #0x0800,d1
		bne.s      ed_wabort_8
ed_wabort_7:
		ori.w      #0x0FE0,34(a2)
		ori.w      #0x0100,86(a2)
		movea.l    a2,a0
		jsr        Awi_closed
		movea.l    a2,a0
		jsr        Awi_open
		andi.w     #0xFEFF,86(a2)
		bra.s      ed_wabort_9
ed_wabort_8:
		movea.l    a2,a0
		jsr        view_shrink
ed_wabort_9:
		movea.l    30(a3),a4
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		bne.s      ed_wabort_5
		move.l     a4,d1
		beq.s      ed_wabort_5
		move.w     (a4)+,d3
		bra.s      ed_wabort_10
ed_wabort_11:
		move.w     (a4)+,d1
		move.w     d1,d0
		add.w      d0,d0
		add.w      d1,d0
		addq.w     #2,d0
		movea.l    a2,a0
		jsr        Adr_add
		subq.w     #1,d3
ed_wabort_10:
		tst.w      d3
		bgt.s      ed_wabort_11
ed_wabort_5:
		movea.l    30(a3),a0
		jsr        Ax_ifree
		clr.l      30(a3)
		movem.l    (a7)+,d3/a2-a4
		rts

	.globl edob_refs
edob_refs:
		movem.l    a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a3
		move.w     10(a3),d0
		bmi.s      edob_refs_1
		move.w     24(a3),d1
		bmi.s      edob_refs_1
		movea.l    4(a3),a1
		movea.l    4(a1),a4
		ext.l      d0
		move.l     d0,d2
		lsl.l      #3,d2
		sub.l      d0,d2
		lsl.l      #3,d2
		adda.l     d2,a4
		movea.l    a4,a0
		jsr        set_aeo
		movea.l    a0,a4
		move.l     a4,d0
		beq.s      edob_refs_1
		move.l     20(a4),-(a7)
		move.l     16(a4),-(a7)
		clr.l      -(a7)
		move.l     8(a4),-(a7)
		move.l     4(a4),-(a7)
		move.l     12(a4),-(a7)
		movea.l    (a0),a1
		movea.l    a2,a0
		jsr        change_work
		lea.l      24(a7),a7
edob_refs_1:
		movem.l    (a7)+,a2-a4
		rts

	.globl change_work
change_work:
		movem.l    d3/a2-a6,-(a7)
		lea.l      -268(a7),a7
		movea.l    a0,a2
		movea.l    a1,a4
		movea.l    308(a7),a6
		ori.w      #0x0001,84(a2)
		jsr        Awi_diaend
		movea.l    (a2),a3
		movea.l    ACSblk,a0
		move.w     582(a0),d3
		tst.w      d3
		ble.s      change_work_1
		cmpa.l     576(a0),a2
		bne.s      change_work_1
		moveq.l    #1,d0
		add.w      d3,d0
		ext.l      d0
		add.l      d0,d0
		jsr        Ax_malloc
		movea.l    a0,a5
		move.l     a0,30(a3)
		move.l     a5,d0
		beq.s      change_work_2
		move.w     d3,(a5)+
		movea.l    ACSblk,a0
		clr.w      584(a0)
		bra.s      change_work_3
change_work_4:
		jsr        Adr_next
		subq.w     #2,d0
		ext.l      d0
		divs.w     #0x0003,d0
		move.w     d0,(a5)+
change_work_3:
		move.w     d3,d0
		subq.w     #1,d3
		tst.w      d0
		bgt.s      change_work_4
change_work_2:
		jsr        Adr_unselect
		bra.s      change_work_5
change_work_1:
		clr.l      30(a3)
change_work_5:
		movea.l    20(a2),a5
		move.w     16(a5),12(a3)
		move.w     18(a5),14(a3)
		move.w     86(a2),d0
		and.w      #0x0800,d0
		beq.s      change_work_6
		move.w     44(a2),16(a3)
		move.w     46(a2),18(a3)
		move.w     48(a2),20(a3)
		move.w     50(a2),22(a3)
		bra.s      change_work_7
change_work_6:
		move.w     36(a2),16(a3)
		move.w     38(a2),18(a3)
		move.w     40(a2),20(a3)
		move.w     42(a2),22(a3)
change_work_7:
		movea.l    94(a2),a0
		jsr        Aob_delete
		move.l     a6,94(a2)
		move.l     a6,d0
		beq.s      change_work_8
		movea.l    a6,a0
		jsr        Ame_namefix
change_work_8:
		movea.l    a5,a0
		jsr        Ax_free
		movea.l    a4,a5
		move.l     a5,20(a2)
		move.w     #0x0002,8(a3)
		movea.l    a5,a0
		jsr        Aob_fix
		moveq.l    #8,d1
		moveq.l    #-1,d0
		movea.l    a5,a0
		jsr        Aob_findflag
		move.w     d0,28(a2)
		move.w     #0xFFFF,30(a2)
		move.l     300(a7),26(a3)
		move.l     304(a7),34(a3)
		move.l     296(a7),d0
		beq.s      change_work_9
		movea.l    d0,a1
		lea.l      (a7),a0
		move.l     #0x00000100,d0
		jsr        strncpy
		move.l     #0x00000100,d0
		movea.l    74(a2),a1
		lea.l      (a7),a0
		jsr        strncat
		lea.l      (a7),a0
		jsr        Ast_create
		move.l     a0,256(a7)
		move.l     a0,d0
		beq.s      change_work_9
		move.l     74(a2),38(a3)
		move.l     d0,74(a2)
		move.w     32(a2),d1
		ble.s      change_work_9
		clr.w      -(a7)
		clr.w      -(a7)
		move.l     d0,-(a7)
		move.w     d1,d0
		moveq.l    #2,d1
		jsr        wind_set
		addq.w     #8,a7
change_work_9:
		move.l     154(a2),42(a3)
		move.l     158(a2),46(a3)
		movea.l    312(a7),a0
		jsr        Ast_create
		move.l     a0,154(a2)
		movea.l    316(a7),a0
		jsr        Ast_create
		move.l     a0,158(a2)
		movea.l    ACSblk,a1
		move.w     4(a1),d0
		add.w      d0,d0
		add.w      20(a5),d0
		move.w     d0,40(a2)
		movea.l    ACSblk,a0
		move.w     6(a0),d1
		lsl.w      #2,d1
		add.w      22(a5),d1
		move.w     d1,42(a2)
		lea.l      260(a7),a4
		move.l     _globl,-(a7)
		pea.l      6(a4)
		pea.l      4(a4)
		movea.l    20(a2),a0
		move.w     22(a0),-(a7)
		move.w     20(a0),-(a7)
		move.w     18(a0),-(a7)
		lea.l      2(a4),a1
		movea.l    a4,a0
		movea.l    20(a2),a3
		move.w     16(a3),d2
		move.w     34(a2),d1
		and.w      #0xF01F,d1
		clr.w      d0
		jsr        mt_wind_calc
		lea.l      18(a7),a7
		move.w     34(a2),d0
		movea.l    ACSblk,a0
		move.w     4(a4),d1
		cmp.w      12(a0),d1
		bge.s      change_work_10
		and.w      #0xF1FF,d0
change_work_10:
		movea.l    ACSblk,a0
		move.w     6(a4),d1
		cmp.w      14(a0),d1
		bge.s      change_work_11
		and.w      #0xFE3F,d0
change_work_11:
		move.w     d0,d1
		and.w      #0x0900,d1
		bne.s      change_work_12
		and.w      #0xFFDF,d0
change_work_12:
		cmp.w      34(a2),d0
		beq.s      change_work_13
		move.w     d0,34(a2)
		ori.w      #0x0100,86(a2)
		movea.l    a2,a0
		jsr        Awi_closed
		movea.l    a2,a0
		jsr        Awi_open
		andi.w     #0xFEFF,86(a2)
		bra.s      change_work_14
change_work_13:
		movea.l    a2,a0
		jsr        view_grow
change_work_14:
		lea.l      268(a7),a7
		movem.l    (a7)+,d3/a2-a6
		rts

	.globl edob_aflags
edob_aflags:
		move.l     a2,-(a7)
		move.l     a3,-(a7)
		lea.l      ACSblk,a0
		movea.l    (a0),a1
		movea.l    600(a1),a2
		movea.l    (a2),a1
		movea.l    (a0),a3
		cmpa.l     576(a3),a2
		bne.s      edob_aflags_1
		move.w     582(a3),d0
		bmi.s      edob_aflags_1
		move.w     24(a1),d1
		bmi.s      edob_aflags_1
		suba.l     a0,a0
		jsr        set_aflags
		movea.l    a0,a3
		move.l     a3,d0
		beq.s      edob_aflags_1
		move.l     20(a3),-(a7)
		move.l     16(a3),-(a7)
		clr.l      -(a7)
		move.l     8(a3),-(a7)
		move.l     4(a3),-(a7)
		move.l     12(a3),-(a7)
		movea.l    (a0),a1
		movea.l    a2,a0
		bsr        change_work
		lea.l      24(a7),a7
edob_aflags_1:
		movea.l    (a7)+,a3
		movea.l    (a7)+,a2
		rts

	.globl edob_hide
edob_hide:
		movem.l    d3-d4/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a3
		movea.l    (a3),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a3),d3
		tst.w      d3
		ble.s      edob_hide_1
		move.w     #0xFFFF,10(a3)
		jsr        Adr_unselect
		movea.l    20(a2),a4
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		move.w     d4,d0
		movea.l    a2,a0
		jsr        undraw
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		ori.w      #0x0080,8(a4,d0.l)
		ori.w      #0x0080,-16(a4,d0.l)
		movea.l    4(a3),a0
		movea.l    4(a0),a4
		move.w     d3,d4
		ext.l      d4
		move.l     d4,d2
		lsl.l      #3,d2
		sub.l      d4,d2
		lsl.l      #3,d2
		ori.w      #0x0080,16(a4,d2.l)
edob_hide_1:
		movem.l    (a7)+,d3-d4/a2-a4
		rts

	.globl set_userdata
set_userdata:
		movem.l    d3-d4/a2-a4,-(a7)
		movea.l    a0,a4
		move.w     d0,d3
		move.w     d1,d4
		movea.l    ACSblk,a1
		movea.l    600(a1),a0
		movea.l    (a0),a2
		movea.l    4(a2),a0
		movea.l    4(a0),a3
		move.w     10(a2),d1
		ext.l      d1
		move.l     d1,d2
		lsl.l      #3,d2
		sub.l      d1,d2
		lsl.l      #3,d2
		adda.l     d2,a3
		move.w     28(a3),d0
		jsr        pixel_x
		cmp.w      d0,d3
		ble.s      set_userdata_1
		move.w     d3,d0
		jsr        char_x
		move.w     d0,28(a3)
set_userdata_1:
		move.w     30(a3),d0
		jsr        pixel_y
		cmp.w      d0,d4
		ble.s      set_userdata_2
		move.w     d4,d0
		jsr        char_y
		move.w     d0,30(a3)
set_userdata_2:
		move.l     a4,-(a7)
		movea.l    20(a3),a1
		movea.l    (a2),a0
		jsr        change_udf
		addq.w     #4,a7
		movem.l    (a7)+,d3-d4/a2-a4
		rts

	.globl edob_specs
edob_specs:
		movem.l    a2-a5,-(a7)
		lea.l      -82(a7),a7
		movea.l    ACSblk,a0
		move.l     600(a0),(a7)
		movea.l    (a7),a1
		movea.l    (a1),a4
		move.w     10(a4),d0
		bmi        edob_specs_1
		movea.l    4(a4),a0
		movea.l    4(a0),a3
		ext.l      d0
		move.l     d0,d1
		lsl.l      #3,d1
		sub.l      d0,d1
		lsl.l      #3,d1
		adda.l     d1,a3
		move.b     15(a3),d2
		ext.w      d2
		sub.w      #0x0014,d2
		cmp.w      #0x000D,d2
		bhi        edob_specs_2
		add.w      d2,d2
		move.w     J22(pc,d2.w),d2
		jmp        J22(pc,d2.w)
J22:
		dc.w edob_specs_3-J22
		dc.w edob_specs_4-J22
		dc.w edob_specs_4-J22
		dc.w edob_specs_5-J22
		dc.w edob_specs_6-J22
		dc.w edob_specs_3-J22
		dc.w edob_specs_7-J22
		dc.w edob_specs_3-J22
		dc.w edob_specs_7-J22
		dc.w edob_specs_4-J22
		dc.w edob_specs_4-J22
		dc.w edob_specs_8-J22
		dc.w edob_specs_7-J22
		dc.w edob_specs_8-J22
edob_specs_3:
		movea.l    a3,a0
		jsr        set_box
		movea.l    a0,a4
		bra        edob_specs_2
edob_specs_4:
		movea.l    a3,a0
		jsr        set_ted
		movea.l    a0,a4
		bra        edob_specs_2
edob_specs_5:
		movea.l    a3,a0
		jsr        set_image
		movea.l    a0,a4
		bra        edob_specs_2
edob_specs_6:
		move.l     20(a3),8(a7)
		movea.l    8(a7),a0
		movea.l    4(a0),a2
		lea.l      6(a7),a5
		move.l     _globl,-(a7)
		pea.l      8(a7)
		pea.l      (a5)
		movea.l    a5,a1
		movea.l    a5,a0
		jsr        mt_graf_mkstate
		lea.l      12(a7),a7
		moveq.l    #4,d0
		and.w      4(a7),d0
		bne.s      edob_specs_9
		movea.l    (a2),a0
		lea.l      22(a0),a0
		jsr        part_get
		movea.l    a0,a5
		move.l     a5,d0
		beq.s      edob_specs_9
		lea.l      8(a3),a1
		lea.l      58(a7),a0
		moveq.l    #24,d0
		jsr        memcpy
		clr.l      70(a7)
		lea.l      12(a7),a1
		movea.l    8(a7),a0
		jsr        set_userdef
		lea.l      58(a7),a1
		lea.l      12(a7),a0
		movea.l    32(a5),a2
		jsr        (a2)
		movea.l    a0,a2
		move.l     a2,d0
		beq.s      edob_specs_9
		move.l     76(a5),-(a7)
		move.l     72(a5),-(a7)
		clr.l      -(a7)
		move.l     44(a5),-(a7)
		move.l     40(a5),-(a7)
		move.l     68(a5),-(a7)
		movea.l    a2,a1
		movea.l    24(a7),a0
		bsr        change_work
		lea.l      24(a7),a7
		bra.s      edob_specs_1
edob_specs_9:
		movea.l    a3,a0
		jsr        set_user
		movea.l    a0,a4
		bra.s      edob_specs_2
edob_specs_7:
		movea.l    a3,a0
		jsr        set_str
		movea.l    a0,a4
		bra.s      edob_specs_2
edob_specs_8:
		movea.l    a3,a0
		jsr        set_icon
		movea.l    a0,a4
edob_specs_2:
		move.l     a4,d0
		beq.s      edob_specs_1
		move.l     20(a4),-(a7)
		move.l     16(a4),-(a7)
		clr.l      -(a7)
		move.l     8(a4),-(a7)
		move.l     4(a4),-(a7)
		move.l     12(a4),-(a7)
		movea.l    (a4),a1
		movea.l    24(a7),a0
		bsr        change_work
		lea.l      24(a7),a7
edob_specs_1:
		lea.l      82(a7),a7
		movem.l    (a7)+,a2-a5
		rts

	.globl open_it
open_it:
		movem.l    d3-d4/a2-a5,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		move.w     608(a0),d3
		jsr        Adr_unselect
		move.w     d3,d0
		movea.l    a2,a0
		jsr        Adr_add
		movea.l    (a2),a3
		moveq.l    #-2,d4
		add.w      d3,d4
		ext.l      d4
		divs.w     #0x0003,d4
		move.w     d4,10(a3)
		movea.l    4(a3),a0
		movea.l    4(a0),a4
		lea.l      OBJ_POPUP,a5
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     10(a4,d0.l),d2
		bmi.s      open_it_1
		andi.w     #0xFFF7,1234(a5)
		bra.s      open_it_2
open_it_1:
		ori.w      #0x0008,1234(a5)
open_it_2:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     18(a4,d0.l),d2
		and.w      #0x1000,d2
		beq.s      open_it_3
		ori.w      #0x0008,1282(a5)
		andi.w     #0xFFF7,1330(a5)
		bra.s      open_it_4
open_it_3:
		andi.w     #0xFFF7,1282(a5)
		ori.w      #0x0008,1330(a5)
open_it_4:
		cmp.w      24(a3),d3
		bne.s      open_it_5
		ori.w      #0x0008,1186(a5)
		ori.w      #0x0008,1378(a5)
		ori.w      #0x0008,1426(a5)
		ori.w      #0x0008,682(a5)
		bra.s      open_it_6
open_it_5:
		andi.w     #0xFFF7,1186(a5)
		andi.w     #0xFFF7,1378(a5)
		andi.w     #0xFFF7,1426(a5)
		andi.w     #0xFFF7,682(a5)
open_it_6:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     10(a4,d0.l),d2
		cmp.w      12(a4,d0.l),d2
		beq.s      open_it_7
		andi.w     #0xFFF7,1978(a5)
		bra.s      open_it_8
open_it_7:
		ori.w      #0x0008,1978(a5)
open_it_8:
		movea.l    a5,a0
		jsr        Aob_fix
		movea.l    1932(a5),a0
		move.w     4(a0),d0
		lsl.w      #3,d0
		move.w     d0,1940(a5)
		move.w     d0,1892(a5)
		move.w     d0,1936(a5)
		move.w     4(a0),d1
		lsl.w      #4,d1
		move.w     d1,1868(a5)
		move.w     6(a0),d0
		move.w     d0,1942(a5)
		move.w     d0,1894(a5)
		move.w     d0,1870(a5)
		jsr        Aev_release
		moveq.l    #-1,d1
		moveq.l    #-1,d0
		movea.l    a5,a1
		movea.l    a2,a0
		jsr        Ame_popup
		movem.l    (a7)+,d3-d4/a2-a5
		rts

	.globl find_papa
find_papa:
		movem.l    d3-d4/a2,-(a7)
		movea.l    a0,a2
		move.w     d0,d3
find_papa_4:
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     8(a2,d0.l),d4
		tst.w      d4
		bpl.s      find_papa_1
		moveq.l    #-1,d0
		bra.s      find_papa_2
find_papa_1:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		cmp.w      12(a2,d0.l),d3
		bne.s      find_papa_3
		move.w     d4,d0
		bra.s      find_papa_2
find_papa_3:
		move.w     d4,d3
		bra.s      find_papa_4
find_papa_2:
		movem.l    (a7)+,d3-d4/a2
		rts

	.globl edob_left
edob_left:
		movem.l    d3-d4/a2-a3,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a0
		movea.l    (a0),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a0),d3
		movea.l    4(a0),a1
		movea.l    4(a1),a3
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		clr.w      24(a3,d0.l)
		movea.l    20(a2),a3
		move.w     d3,d2
		add.w      d2,d2
		add.w      d3,d2
		addq.w     #2,d2
		move.w     d2,d3
		move.w     d3,d0
		movea.l    a3,a0
		jsr        Aob_up
		move.w     d0,d4
		clr.w      d1
		move.w     d3,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     d1,16(a3,d2.l)
		move.w     d1,-8(a3,d2.l)
		jsr        Adr_unselect
		move.w     d4,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
		movem.l    (a7)+,d3-d4/a2-a3
		rts

	.globl edob_right
edob_right:
		movem.l    d3-d6/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a3
		movea.l    (a3),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a3),d3
		movea.l    20(a2),a4
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		move.w     d4,d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,d5
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     20(a4,d1.l),d0
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		sub.w      20(a4,d2.l),d0
		jsr        char_x
		move.w     d0,d6
		jsr        pixel_x
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     d0,16(a4,d1.l)
		move.w     d0,-8(a4,d1.l)
		jsr        Adr_unselect
		move.w     d5,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
		movea.l    4(a3),a0
		movea.l    4(a0),a4
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d6,24(a4,d0.l)
		movem.l    (a7)+,d3-d6/a2-a4
		rts

	.globl edob_center
edob_center:
		movem.l    d3-d6/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a3
		movea.l    (a3),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a3),d3
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		movea.l    20(a2),a4
		move.w     d4,d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,d5
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     20(a4,d1.l),d0
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		sub.w      20(a4,d2.l),d0
		asr.w      #1,d0
		jsr        char_x
		move.w     d0,d6
		jsr        pixel_x
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     d0,16(a4,d1.l)
		move.w     d0,-8(a4,d1.l)
		jsr        Adr_unselect
		move.w     d5,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
		movea.l    4(a3),a0
		movea.l    4(a0),a4
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d6,24(a4,d0.l)
		movem.l    (a7)+,d3-d6/a2-a4
		rts

	.globl edob_horfill
edob_horfill:
		movem.l    d3-d6/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a0
		movea.l    (a0),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a0),d3
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		movea.l    20(a2),a3
		movea.l    4(a0),a1
		movea.l    4(a1),a4
		move.w     d4,d0
		movea.l    a3,a0
		jsr        Aob_up
		move.w     d0,d5
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     20(a3,d1.l),d6
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		sub.w      20(a3,d2.l),d6
		movea.l    a3,a1
		movea.l    a4,a0
		move.w     d3,d0
		move.w     d6,d1
		clr.w      d2
		jsr        resize_ob
		clr.w      d0
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     d0,16(a3,d1.l)
		move.w     d0,-8(a3,d1.l)
		move.w     d5,d0
		ext.l      d0
		move.l     d0,d6
		add.l      d6,d6
		add.l      d0,d6
		lsl.l      #3,d6
		move.w     20(a3,d6.l),d2
		move.w     d2,20(a3,d1.l)
		move.w     d2,-4(a3,d1.l)
		jsr        Adr_unselect
		move.w     d4,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
		moveq.l    #-2,d0
		add.w      d5,d0
		ext.l      d0
		divs.w     #0x0003,d0
		move.w     d0,d5
		move.w     d3,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		clr.w      24(a4,d1.l)
		ext.l      d0
		move.l     d0,d4
		lsl.l      #3,d4
		sub.l      d0,d4
		lsl.l      #3,d4
		move.w     28(a4,d4.l),28(a4,d1.l)
		movem.l    (a7)+,d3-d6/a2-a4
		rts

	.globl edob_top
edob_top:
		movem.l    d3-d5/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a3
		movea.l    (a3),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a3),d3
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		movea.l    20(a2),a4
		move.w     d4,d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,d5
		clr.w      d1
		move.w     d4,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		move.w     d1,18(a4,d2.l)
		move.w     d1,-6(a4,d2.l)
		movea.l    4(a3),a0
		movea.l    4(a0),a4
		move.w     d3,d4
		ext.l      d4
		move.l     d4,d1
		lsl.l      #3,d1
		sub.l      d4,d1
		lsl.l      #3,d1
		clr.w      26(a4,d1.l)
		jsr        Adr_unselect
		move.w     d5,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
		movem.l    (a7)+,d3-d5/a2-a4
		rts

	.globl edob_bottom
edob_bottom:
		movem.l    d3-d6/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a3
		movea.l    (a3),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a3),d3
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		movea.l    20(a2),a4
		move.w     d4,d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,d5
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     22(a4,d1.l),d0
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		sub.w      22(a4,d2.l),d0
		jsr        char_y
		move.w     d0,d6
		jsr        pixel_y
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     d0,18(a4,d1.l)
		move.w     d0,-6(a4,d1.l)
		jsr        Adr_unselect
		move.w     d5,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
		movea.l    4(a3),a0
		movea.l    4(a0),a4
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d6,26(a4,d0.l)
		movem.l    (a7)+,d3-d6/a2-a4
		rts

	.globl edob_mid
edob_mid:
		movem.l    d3-d6/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a3
		movea.l    (a3),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a3),d3
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		movea.l    20(a2),a4
		move.w     d4,d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,d5
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     22(a4,d1.l),d0
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		sub.w      22(a4,d2.l),d0
		asr.w      #1,d0
		jsr        char_y
		move.w     d0,d6
		jsr        pixel_y
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     d0,18(a4,d1.l)
		move.w     d0,-6(a4,d1.l)
		jsr        Adr_unselect
		move.w     d5,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
		movea.l    4(a3),a0
		movea.l    4(a0),a4
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d6,26(a4,d0.l)
		movem.l    (a7)+,d3-d6/a2-a4
		rts

	.globl edob_verfill
edob_verfill:
		movem.l    d3-d6/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a0
		movea.l    (a0),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a0),d3
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		movea.l    20(a2),a3
		movea.l    4(a0),a1
		movea.l    4(a1),a4
		move.w     d4,d0
		movea.l    a3,a0
		jsr        Aob_up
		move.w     d0,d5
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		move.w     22(a3,d1.l),d6
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		sub.w      22(a3,d2.l),d6
		movea.l    a3,a1
		movea.l    a4,a0
		move.w     d3,d0
		clr.w      d1
		move.w     d6,d2
		jsr        resize_ob
		clr.w      d0
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     d0,18(a3,d1.l)
		move.w     d0,-6(a3,d1.l)
		move.w     d5,d0
		ext.l      d0
		move.l     d0,d6
		add.l      d6,d6
		add.l      d0,d6
		lsl.l      #3,d6
		move.w     22(a3,d6.l),d2
		move.w     d2,22(a3,d1.l)
		move.w     d2,-2(a3,d1.l)
		jsr        Adr_unselect
		move.w     d4,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
		moveq.l    #-2,d0
		add.w      d5,d0
		ext.l      d0
		divs.w     #0x0003,d0
		move.w     d0,d5
		move.w     d3,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		clr.w      26(a4,d1.l)
		ext.l      d0
		move.l     d0,d4
		lsl.l      #3,d4
		sub.l      d0,d4
		lsl.l      #3,d4
		move.w     30(a4,d4.l),30(a4,d1.l)
		movem.l    (a7)+,d3-d6/a2-a4
		rts

	.globl edob_up
edob_up:
		movem.l    d3-d7/a2-a4,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a3
		move.w     10(a3),d3
		movea.l    4(a3),a1
		movea.l    4(a1),a4
		move.w     d3,d0
		movea.l    a4,a0
		bsr        find_papa
		move.w     d0,d4
		ext.l      d0
		move.l     d0,d1
		lsl.l      #3,d1
		sub.l      d0,d1
		lsl.l      #3,d1
		move.w     12(a4,d1.l),d5
		cmp.w      d5,d3
		beq        edob_up_1
		movea.l    (a3),a0
		ori.w      #0x0001,6(a0)
		move.w     10(a4,d1.l),d6
		cmp.w      d6,d3
		bne.s      edob_up_2
		move.w     d3,d0
		ext.l      d0
		move.l     d0,d2
		lsl.l      #3,d2
		sub.l      d0,d2
		lsl.l      #3,d2
		move.w     8(a4,d2.l),10(a4,d1.l)
		bra.s      edob_up_3
edob_up_2:
		move.w     d6,d7
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     8(a4,d0.l),d6
		cmp.w      d6,d3
		bne.s      edob_up_2
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d7,d6
		ext.l      d6
		move.l     d6,d2
		lsl.l      #3,d2
		sub.l      d6,d2
		lsl.l      #3,d2
		move.w     8(a4,d0.l),8(a4,d2.l)
edob_up_3:
		move.w     d5,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d3,8(a4,d0.l)
		move.w     d3,d5
		ext.l      d5
		move.l     d5,d2
		lsl.l      #3,d2
		sub.l      d5,d2
		lsl.l      #3,d2
		move.w     d4,8(a4,d2.l)
		move.w     d4,d7
		ext.l      d7
		move.l     d7,d6
		lsl.l      #3,d6
		sub.l      d7,d6
		lsl.l      #3,d6
		move.w     d3,12(a4,d6.l)
		movea.l    a2,a0
		movea.l    16(a2),a1
		jsr        (a1)
		move.w     d4,d7
		add.w      d7,d7
		add.w      d4,d7
		addq.w     #2,d7
		move.w     d7,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
edob_up_1:
		movem.l    (a7)+,d3-d7/a2-a4
		rts

	.globl edob_down
edob_down:
		movem.l    d3-d7/a2-a3,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    (a2),a0
		movea.l    (a0),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a0),d3
		movea.l    4(a0),a1
		movea.l    4(a1),a3
		move.w     d3,d0
		movea.l    a3,a0
		bsr        find_papa
		move.w     d0,d4
		ext.l      d0
		move.l     d0,d1
		lsl.l      #3,d1
		sub.l      d0,d1
		lsl.l      #3,d1
		move.w     10(a3,d1.l),d5
		cmp.w      d5,d3
		beq        edob_down_1
		move.w     d5,d6
edob_down_2:
		move.w     d6,d7
		move.w     d7,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     8(a3,d0.l),d6
		cmp.w      d6,d3
		bne.s      edob_down_2
		move.w     d4,d6
		ext.l      d6
		move.l     d6,d2
		lsl.l      #3,d2
		sub.l      d6,d2
		lsl.l      #3,d2
		cmp.w      12(a3,d2.l),d3
		bne.s      edob_down_3
		move.w     d7,12(a3,d2.l)
		move.w     d4,8(a3,d0.l)
		bra.s      edob_down_4
edob_down_3:
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d7,d6
		ext.l      d6
		move.l     d6,d2
		lsl.l      #3,d2
		sub.l      d6,d2
		lsl.l      #3,d2
		move.w     8(a3,d0.l),8(a3,d2.l)
edob_down_4:
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d5,8(a3,d0.l)
		move.w     d4,d6
		ext.l      d6
		move.l     d6,d2
		lsl.l      #3,d2
		sub.l      d6,d2
		lsl.l      #3,d2
		move.w     d3,10(a3,d2.l)
		movea.l    a2,a0
		movea.l    16(a2),a1
		jsr        (a1)
		move.w     d4,d7
		add.w      d7,d7
		add.w      d4,d7
		addq.w     #2,d7
		move.w     d7,d0
		movea.l    a2,a0
		jsr        Awi_obredraw
edob_down_1:
		movem.l    (a7)+,d3-d7/a2-a3
		rts

	.globl sort
sort:
		movem.l    d3-d7/a2-a4,-(a7)
		subq.w     #4,a7
		movea.l    a0,a2
		move.w     d0,d4
		movea.l    (a0),a3
		move.w     10(a3),2(a7)
		movea.l    4(a3),a1
		movea.l    4(a1),a4
		move.w     2(a7),d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     10(a4,d1.l),(a7)
		move.w     12(a4,d1.l),d5
		move.w     d5,d2
		ext.l      d2
		move.l     d2,d0
		lsl.l      #3,d0
		sub.l      d2,d0
		lsl.l      #3,d0
		move.w     #0xFFFF,8(a4,d0.l)
sort_9:
		clr.w      d5
		move.w     (a7),d6
		moveq.l    #-1,d7
sort_8:
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     8(a4,d0.l),d3
		tst.w      d3
		bmi        sort_1
		tst.w      d4
		beq.s      sort_2
		move.w     d3,d0
		ext.l      d0
		move.l     d0,d2
		lsl.l      #3,d2
		sub.l      d0,d2
		lsl.l      #3,d2
		move.w     26(a4,d2.l),d0
		jsr        pixel_y
		move.w     d0,-(a7)
		move.w     d6,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     26(a4,d1.l),d0
		jsr        pixel_y
		cmp.w      (a7)+,d0
		bge.s      sort_3
sort_2:
		tst.w      d4
		bne        sort_4
		move.w     d3,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     24(a4,d1.l),d0
		jsr        pixel_x
		move.w     d0,-(a7)
		move.w     d6,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     24(a4,d1.l),d0
		jsr        pixel_x
		cmp.w      (a7)+,d0
		blt        sort_4
sort_3:
		move.w     d3,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     26(a4,d1.l),d0
		jsr        pixel_y
		move.w     d0,-(a7)
		move.w     d6,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     26(a4,d1.l),d0
		jsr        pixel_y
		cmp.w      (a7)+,d0
		bgt.s      sort_5
		move.w     d3,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     24(a4,d1.l),d0
		jsr        pixel_x
		move.w     d0,-(a7)
		move.w     d6,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     24(a4,d1.l),d0
		jsr        pixel_x
		cmp.w      (a7)+,d0
		ble.s      sort_4
sort_5:
		moveq.l    #1,d5
		movea.l    (a3),a0
		or.w       d5,6(a0)
		tst.w      d7
		bpl.s      sort_6
		move.w     d3,(a7)
		bra.s      sort_7
sort_6:
		move.w     d7,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d3,8(a4,d0.l)
sort_7:
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d2
		lsl.l      #3,d2
		sub.l      d1,d2
		lsl.l      #3,d2
		move.w     8(a4,d0.l),8(a4,d2.l)
		move.w     d6,8(a4,d0.l)
		move.w     d3,d7
		move.w     d6,d3
		move.w     d7,d6
sort_4:
		move.w     d6,d7
		move.w     d3,d6
		bra        sort_8
sort_1:
		tst.w      d5
		bne        sort_9
		move.w     2(a7),d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     (a7),10(a4,d0.l)
		move.w     d6,12(a4,d0.l)
		move.w     d6,d3
		ext.l      d3
		move.l     d3,d2
		lsl.l      #3,d2
		sub.l      d3,d2
		lsl.l      #3,d2
		move.w     2(a7),8(a4,d2.l)
		movea.l    a2,a0
		movea.l    16(a2),a1
		jsr        (a1)
		move.w     2(a7),d0
		move.w     d0,d4
		add.w      d4,d4
		add.w      d0,d4
		addq.w     #2,d4
		movea.l    a2,a0
		move.w     d4,d0
		jsr        Awi_obredraw
		addq.w     #4,a7
		movem.l    (a7)+,d3-d7/a2-a4
		rts

	.globl edob_sortxy
edob_sortxy:
		moveq.l    #1,d0
		movea.l    ACSblk,a0
		movea.l    600(a0),a0
		bsr        sort
		rts

	.globl edob_sortyx
edob_sortyx:
		clr.w      d0
		movea.l    ACSblk,a0
		movea.l    600(a0),a0
		bsr        sort
		rts

	.globl edob_lock
edob_lock:
		movem.l    d3-d4/a2-a3,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a3
		movea.l    (a3),a2
		movea.l    (a2),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a2),d3
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		jsr        Adr_unselect
		movea.l    20(a3),a3
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		ori.w      #0x1000,10(a3,d0.l)
		movea.l    4(a2),a0
		movea.l    4(a0),a3
		move.w     d3,d4
		ext.l      d4
		move.l     d4,d2
		lsl.l      #3,d2
		sub.l      d4,d2
		lsl.l      #3,d2
		ori.w      #0x1000,18(a3,d2.l)
		movem.l    (a7)+,d3-d4/a2-a3
		rts

	.globl edob_unlock
edob_unlock:
		movem.l    d3-d4/a2-a3,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a3
		movea.l    (a3),a2
		movea.l    (a2),a1
		ori.w      #0x0001,6(a1)
		move.w     10(a2),d3
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		jsr        Adr_unselect
		movea.l    20(a3),a3
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		andi.w     #0xEFFF,10(a3,d0.l)
		movea.l    4(a2),a0
		movea.l    4(a0),a3
		move.w     d3,d4
		ext.l      d4
		move.l     d4,d2
		lsl.l      #3,d2
		sub.l      d4,d2
		lsl.l      #3,d2
		andi.w     #0xEFFF,18(a3,d2.l)
		movem.l    (a7)+,d3-d4/a2-a3
		rts

	.globl edob_unhide
edob_unhide:
		movem.l    d3-d6/a2-a5,-(a7)
		movea.l    ACSblk,a0
		movea.l    600(a0),a2
		movea.l    20(a2),a3
		movea.l    (a2),a4
		move.w     10(a4),d3
		movea.l    4(a4),a1
		movea.l    4(a1),a5
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     10(a5,d0.l),d4
		tst.w      d4
		bmi        edob_unhide_1
		clr.w      d5
		bra.s      edob_unhide_2
edob_unhide_4:
		move.w     #0x0080,d0
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		and.w      16(a5,d1.l),d0
		beq.s      edob_unhide_3
		moveq.l    #1,d5
		move.w     d4,d6
		add.w      d6,d6
		add.w      d4,d6
		add.w      d5,d6
		move.w     d6,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		andi.w     #0xFF7F,8(a3,d0.l)
		andi.w     #0xFF7F,32(a3,d0.l)
		move.w     d4,d6
		ext.l      d6
		move.l     d6,d2
		lsl.l      #3,d2
		sub.l      d6,d2
		lsl.l      #3,d2
		andi.w     #0xFF7F,16(a5,d2.l)
edob_unhide_3:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     8(a5,d0.l),d4
edob_unhide_2:
		cmp.w      d4,d3
		bne.s      edob_unhide_4
		tst.w      d5
		beq.s      edob_unhide_1
		movea.l    (a4),a0
		ori.w      #0x0001,6(a0)
		move.w     d3,d0
		add.w      d0,d0
		add.w      d3,d0
		addq.w     #1,d0
		move.w     d0,d3
		movea.l    a2,a0
		jsr        Awi_obredraw
edob_unhide_1:
		movem.l    (a7)+,d3-d6/a2-a5
		rts

	.globl edob_pos
edob_pos:
		movem.l    d3-d7/a2-a5,-(a7)
		lea.l      -10(a7),a7
		movea.l    ACSblk,a0
		move.l     600(a0),(a7)
		movea.l    (a7),a1
		movea.l    (a1),a2
		move.w     10(a2),d3
		tst.w      d3
		bmi        edob_pos_1
		move.w     24(a2),d0
		bmi        edob_pos_1
		lea.l      WI_POSITION,a0
		movea.l    WI_POSITION+8,a1
		jsr        (a1)
		movea.l    a0,a3
		move.l     a3,d0
		beq        edob_pos_1
		movea.l    (a7),a1
		movea.l    20(a1),a4
		movea.l    4(a2),a0
		movea.l    4(a0),a5
		move.w     d3,d2
		ext.l      d2
		move.l     d2,d1
		lsl.l      #3,d1
		sub.l      d2,d1
		lsl.l      #3,d1
		move.w     24(a5,d1.l),d0
		and.w      #0x00FF,d0
		move.w     d0,-(a7)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #7,d0
		jsr        Aob_printf
		addq.w     #2,a7
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     26(a5,d0.l),d2
		and.w      #0x00FF,d2
		move.w     d2,-(a7)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #8,d0
		jsr        Aob_printf
		addq.w     #2,a7
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     28(a5,d0.l),d2
		and.w      #0x00FF,d2
		move.w     d2,-(a7)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #9,d0
		jsr        Aob_printf
		addq.w     #2,a7
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     30(a5,d0.l),d2
		and.w      #0x00FF,d2
		move.w     d2,-(a7)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #10,d0
		jsr        Aob_printf
		addq.w     #2,a7
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     24(a5,d0.l),d2
		asr.w      #8,d2
		move.w     d2,-(a7)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #12,d0
		jsr        Aob_printf
		addq.w     #2,a7
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     26(a5,d0.l),d2
		asr.w      #8,d2
		move.w     d2,-(a7)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #13,d0
		jsr        Aob_printf
		addq.w     #2,a7
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     28(a5,d0.l),d2
		asr.w      #8,d2
		move.w     d2,-(a7)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #14,d0
		jsr        Aob_printf
		addq.w     #2,a7
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		move.w     30(a5,d0.l),d2
		asr.w      #8,d2
		move.w     d2,-(a7)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #15,d0
		jsr        Aob_printf
		addq.w     #2,a7
		move.w     d3,d4
		add.w      d4,d4
		add.w      d3,d4
		addq.w     #2,d4
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     20(a4,d0.l),d5
		move.w     22(a4,d0.l),d6
		movea.l    a3,a0
		jsr        Awi_dialog
		cmp.w      #0x0013,d0
		bne        edob_pos_2
		movea.l    (a2),a0
		ori.w      #0x0001,6(a0)
		lea.l      8(a7),a2
		tst.w      d3
		beq        edob_pos_3
		pea.l      (a2)
		lea.l      xc91d5,a1
		moveq.l    #7,d0
		movea.l    20(a3),a0
		jsr        Aob_scanf
		addq.w     #4,a7
		pea.l      6(a7)
		lea.l      xc91d5,a1
		moveq.l    #12,d0
		movea.l    20(a3),a0
		jsr        Aob_scanf
		addq.w     #4,a7
		cmpi.w     #0x00FF,(a2)
		ble.s      edob_pos_4
		move.w     #0x00FF,(a2)
		bra.s      edob_pos_5
edob_pos_4:
		move.w     (a2),d0
		bpl.s      edob_pos_5
		clr.w      (a2)
edob_pos_5:
		cmpi.w     #0x007F,6(a7)
		ble.s      edob_pos_6
		move.w     #0x007F,6(a7)
		bra.s      edob_pos_7
edob_pos_6:
		cmpi.w     #0xFF80,6(a7)
		bge.s      edob_pos_7
		move.w     #0xFF80,6(a7)
edob_pos_7:
		move.w     (a2),d0
		and.w      #0x00FF,d0
		move.w     6(a7),d1
		lsl.w      #8,d1
		or.w       d1,d0
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d2
		lsl.l      #3,d2
		sub.l      d1,d2
		lsl.l      #3,d2
		move.w     d0,24(a5,d2.l)
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		move.w     d0,16(a4,d2.l)
		move.w     d0,-8(a4,d2.l)
		pea.l      (a2)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #8,d0
		jsr        Aob_scanf
		addq.w     #4,a7
		pea.l      6(a7)
		lea.l      xc91d5,a1
		moveq.l    #13,d0
		movea.l    20(a3),a0
		jsr        Aob_scanf
		addq.w     #4,a7
		cmpi.w     #0x00FF,(a2)
		ble.s      edob_pos_8
		move.w     #0x00FF,(a2)
		bra.s      edob_pos_9
edob_pos_8:
		move.w     (a2),d0
		bpl.s      edob_pos_9
		clr.w      (a2)
edob_pos_9:
		cmpi.w     #0x007F,6(a7)
		ble.s      edob_pos_10
		move.w     #0x007F,6(a7)
		bra.s      edob_pos_11
edob_pos_10:
		cmpi.w     #0xFF80,6(a7)
		bge.s      edob_pos_11
		move.w     #0xFF80,6(a7)
edob_pos_11:
		move.w     (a2),d0
		and.w      #0x00FF,d0
		move.w     6(a7),d1
		lsl.w      #8,d1
		or.w       d1,d0
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d2
		lsl.l      #3,d2
		sub.l      d1,d2
		lsl.l      #3,d2
		move.w     d0,26(a5,d2.l)
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		move.w     d0,18(a4,d2.l)
		move.w     d0,-6(a4,d2.l)
		bra.s      edob_pos_12
edob_pos_3:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		move.w     16(a4,d0.l),4(a7)
		move.w     18(a4,d0.l),d7
edob_pos_12:
		pea.l      (a2)
		lea.l      xc91d5,a1
		moveq.l    #9,d0
		movea.l    20(a3),a0
		jsr        Aob_scanf
		addq.w     #4,a7
		pea.l      6(a7)
		lea.l      xc91d5,a1
		moveq.l    #14,d0
		movea.l    20(a3),a0
		jsr        Aob_scanf
		addq.w     #4,a7
		cmpi.w     #0x00FF,(a2)
		ble.s      edob_pos_13
		move.w     #0x00FF,(a2)
		bra.s      edob_pos_14
edob_pos_13:
		move.w     (a2),d0
		bpl.s      edob_pos_14
		clr.w      (a2)
edob_pos_14:
		cmpi.w     #0x007F,6(a7)
		ble.s      edob_pos_15
		move.w     #0x007F,6(a7)
		bra.s      edob_pos_16
edob_pos_15:
		cmpi.w     #0xFF80,6(a7)
		bge.s      edob_pos_16
		move.w     #0xFF80,6(a7)
edob_pos_16:
		move.w     (a2),d0
		and.w      #0x00FF,d0
		move.w     6(a7),d1
		lsl.w      #8,d1
		or.w       d1,d0
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d2
		lsl.l      #3,d2
		sub.l      d1,d2
		lsl.l      #3,d2
		move.w     d0,28(a5,d2.l)
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		move.w     d0,20(a4,d2.l)
		move.w     d0,-4(a4,d2.l)
		pea.l      (a2)
		lea.l      xc91d5,a1
		movea.l    20(a3),a0
		moveq.l    #10,d0
		jsr        Aob_scanf
		addq.w     #4,a7
		pea.l      6(a7)
		lea.l      xc91d5,a1
		moveq.l    #15,d0
		movea.l    20(a3),a0
		jsr        Aob_scanf
		addq.w     #4,a7
		cmpi.w     #0x00FF,(a2)
		ble.s      edob_pos_17
		move.w     #0x00FF,(a2)
		bra.s      edob_pos_18
edob_pos_17:
		move.w     (a2),d0
		bpl.s      edob_pos_18
		clr.w      (a2)
edob_pos_18:
		cmpi.w     #0x007F,6(a7)
		ble.s      edob_pos_19
		move.w     #0x007F,6(a7)
		bra.s      edob_pos_20
edob_pos_19:
		cmpi.w     #0xFF80,6(a7)
		bge.s      edob_pos_20
		move.w     #0xFF80,6(a7)
edob_pos_20:
		move.w     (a2),d0
		and.w      #0x00FF,d0
		move.w     6(a7),d1
		lsl.w      #8,d1
		or.w       d1,d0
		move.w     d3,d1
		ext.l      d1
		move.l     d1,d2
		lsl.l      #3,d2
		sub.l      d1,d2
		lsl.l      #3,d2
		move.w     d0,30(a5,d2.l)
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d2
		add.l      d2,d2
		add.l      d1,d2
		lsl.l      #3,d2
		move.w     d0,22(a4,d2.l)
		move.w     d0,-2(a4,d2.l)
		movea.l    _globl,a1
		moveq.l    #-1,d0
		add.w      d4,d0
		movea.l    a4,a0
		jsr        mt_rsrc_obfix
		movea.l    _globl,a1
		move.w     d4,d0
		movea.l    a4,a0
		jsr        mt_rsrc_obfix
		tst.w      d3
		bne.s      edob_pos_21
		move.w     4(a7),d0
		move.w     d4,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		move.w     d0,16(a4,d1.l)
		move.w     d0,-8(a4,d1.l)
		move.w     d7,18(a4,d1.l)
		move.w     d7,-6(a4,d1.l)
edob_pos_21:
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		sub.w      20(a4,d0.l),d5
		sub.w      22(a4,d0.l),d6
		tst.w      d5
		bne.s      edob_pos_22
		tst.w      d6
		beq.s      edob_pos_23
edob_pos_22:
		movea.l    a4,a1
		move.w     d6,d2
		neg.w      d2
		move.w     d5,d1
		neg.w      d1
		move.w     d3,d0
		movea.l    a5,a0
		jsr        resize_ob
edob_pos_23:
		move.w     d4,d0
		movea.l    a4,a0
		jsr        Aob_up
		move.w     d0,d7
		jsr        Adr_unselect
		tst.w      d3
		bne.s      edob_pos_24
		movea.l    (a7),a0
		movea.l    (a7),a1
		movea.l    16(a1),a1
		jsr        (a1)
		movea.l    (a7),a0
		ori.w      #0x0010,86(a0)
		movea.l    a0,a1
		lea.l      36(a1),a1
		movea.l    134(a0),a2
		jsr        (a2)
		bra.s      edob_pos_2
edob_pos_24:
		move.w     d7,d0
		movea.l    (a7),a0
		jsr        Awi_obredraw
edob_pos_2:
		movea.l    a3,a0
		jsr        Awi_delete
edob_pos_1:
		lea.l      10(a7),a7
		movem.l    (a7)+,d3-d7/a2-a5
		rts

	.globl edob_resetref
edob_resetref:
		movem.l    d3-d4/a2-a4,-(a7)
		subq.w     #4,a7
		lea.l      ACSblk,a0
		movea.l    (a0),a1
		movea.l    600(a1),a1
		movea.l    (a0),a2
		cmpa.l     576(a2),a1
		bne        edob_resetref_1
		move.w     582(a2),d0
		bmi        edob_resetref_1
		movea.l    (a1),a1
		movea.l    (a1),a2
		ori.w      #0x0001,6(a2)
		movea.l    4(a1),a3
		move.l     4(a3),(a7)
		movea.l    (a0),a1
		clr.w      584(a1)
		lea.l      xc91ce,a3
		bra        edob_resetref_2
edob_resetref_4:
		moveq.l    #-2,d4
		add.w      d3,d4
		ext.l      d4
		divs.w     #0x0003,d4
		move.w     d4,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #3,d0
		sub.l      d1,d0
		lsl.l      #3,d0
		movea.l    (a7),a4
		adda.l     d0,a4
		clr.w      42(a4)
		move.l     (a4),d2
		beq.s      edob_resetref_3
		movea.l    d2,a1
		movea.l    a2,a0
		jsr        objfree
		clr.l      (a4)
edob_resetref_3:
		pea.l      6(a3)
		clr.w      d0
		lea.l      4(a4),a1
		movea.l    a2,a0
		jsr        mod_ref
		addq.w     #4,a7
		pea.l      6(a3)
		moveq.l    #1,d0
		lea.l      32(a4),a1
		movea.l    a2,a0
		jsr        mod_ref
		addq.w     #4,a7
		pea.l      6(a3)
		moveq.l    #2,d0
		lea.l      36(a4),a1
		movea.l    a2,a0
		jsr        mod_ref
		addq.w     #4,a7
		pea.l      6(a3)
		clr.w      d0
		lea.l      44(a4),a1
		movea.l    a2,a0
		jsr        mod_ref
		addq.w     #4,a7
		pea.l      6(a3)
		clr.w      d0
		lea.l      48(a4),a1
		movea.l    a2,a0
		jsr        mod_ref
		addq.w     #4,a7
edob_resetref_2:
		jsr        Adr_next
		move.w     d0,d3
		bpl        edob_resetref_4
edob_resetref_1:
		addq.w     #4,a7
		movem.l    (a7)+,d3-d4/a2-a4
		rts

	.globl oe_beself
oe_beself:
		movem.l    d3/a2-a3,-(a7)
		lea.l      -10(a7),a7
		movea.l    a1,a2
		move.w     d0,d3
		and.w      #0x0FFF,d0
		ext.l      d0
		move.l     d0,d1
		add.l      d1,d1
		add.l      d0,d1
		lsl.l      #3,d1
		movea.l    12(a2,d1.l),a3
		move.l     a0,(a7)
		lea.l      0(a2,d1.l),a1
		move.l     a1,4(a7)
		move.w     d3,8(a7)
		lea.l      (a7),a1
		movea.l    8(a3),a2
		movea.l    4(a7),a0
		moveq.l    #9,d0
		jsr        (a2)
		lea.l      10(a7),a7
		movem.l    (a7)+,d3/a2-a3
		rts

	.globl oe_colsel
oe_colsel:
		movem.l    d3-d5/a2-a3,-(a7)
		subq.w     #8,a7
		move.w     d0,d4
		move.w     d1,d3
		move.w     d2,d5
		lea.l      POP_COLSEL,a0
		jsr        Aob_create
		movea.l    a0,a2
		move.l     a2,d0
		bne.s      oe_colsel_1
		moveq.l    #-1,d0
		bra        oe_colsel_2
oe_colsel_1:
		lea.l      ACSblk,a3
		move.w     d3,d0
		movea.l    (a3),a0
		movea.l    600(a0),a1
		movea.l    20(a1),a1
		lea.l      (a7),a0
		jsr        Aob_offset
		moveq.l    #1,d0
		movea.l    (a3),a0
		movea.l    600(a0),a1
		add.w      52(a1),d0
		add.w      d0,(a7)
		moveq.l    #1,d1
		add.w      54(a1),d1
		add.w      d1,2(a7)
		move.w     d4,d0
		add.w      d0,d0
		ext.l      d0
		move.l     d0,d2
		add.l      d2,d2
		add.l      d0,d2
		lsl.l      #3,d2
		ori.w      #0x0004,34(a2,d2.l)
		move.w     2(a7),d1
		movea.l    a2,a1
		movea.l    (a3),a0
		movea.l    600(a0),a0
		move.w     (a7),d0
		jsr        Ame_popup
		move.w     d0,d4
		bmi.s      oe_colsel_3
		moveq.l    #-2,d1
		and.w      d0,d1
		ext.l      d1
		divs.w     #0x0002,d1
		move.w     d1,d4
		ext.l      d1
		lsl.l      #2,d1
		lea.l      colour_text,a0
		movea.l    0(a0,d1.l),a1
		move.w     d5,d0
		movea.l    (a3),a0
		movea.l    604(a0),a0
		jsr        Aob_puttext
		move.w     32(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    (a3),a0
		movea.l    604(a0),a1
		move.w     d4,d2
		andi.w     #0xFFF0,14(a1,d0.l)
		and.w      #0x000F,d2
		or.w       d2,14(a1,d0.l)
		movea.l    (a3),a0
		movea.l    600(a0),a0
		movea.l    (a3),a1
		movea.l    600(a1),a1
		movea.l    102(a1),a1
		move.w     d3,d0
		moveq.l    #-1,d1
		jsr        (a1)
oe_colsel_3:
		movea.l    a2,a0
		jsr        Aob_delete
		move.w     d4,d0
oe_colsel_2:
		addq.w     #8,a7
		movem.l    (a7)+,d3-d5/a2-a3
		rts

	.data

xc91ce:
		dc.b '0x%lxL',0
xc91d5:
		dc.b '%d',0
		.even

