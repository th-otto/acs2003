		.text
		
copyref:
		move.l     a2,-(a7)
		movea.l    a1,a2
		move.l     (a1),d0
		beq.s      copyref_1
		movea.l    d0,a1
		jsr        add_ref
		move.l     a0,(a2)
copyref_1:
		movea.l    (a7)+,a2
		rts

copy_window:
		movem.l    a2-a5,-(a7)
		movea.l    a0,a3
		movea.l    a1,a2
		move.l     14(a2),d0
		jsr        objmalloc
		movea.l    a0,a4
		move.l     a4,d0
		bne.s      copy_window_1
		suba.l     a0,a0
		bra        copy_window_2
copy_window_1:
		move.l     14(a2),14(a4)
		movea.l    4(a4),a5
		move.l     14(a2),d0
		movea.l    4(a2),a1
		movea.l    a5,a0
		jsr        memcpy
		movea.l    a5,a1
		movea.l    a3,a0
		bsr.w      copyref
		lea.l      12(a5),a1
		movea.l    a3,a0
		bsr.w      copyref
		lea.l      4(a5),a1
		movea.l    a3,a0
		bsr.w      copyref
		lea.l      8(a5),a1
		movea.l    a3,a0
		bsr.w      copyref
		move.l     20(a5),d0
		beq.s      copy_window_3
		movea.l    d0,a1
		movea.l    a3,a0
		jsr        add_object
		move.l     a0,20(a5)
copy_window_3:
		move.l     24(a5),d0
		beq.s      copy_window_4
		movea.l    d0,a1
		movea.l    a3,a0
		jsr        add_object
		move.l     a0,24(a5)
copy_window_4:
		movea.l    74(a5),a1
		movea.l    a3,a0
		jsr        add_string
		move.l     a0,74(a5)
		movea.l    78(a5),a1
		movea.l    a3,a0
		jsr        add_string
		move.l     a0,78(a5)
		move.l     90(a5),d0
		beq.s      copy_window_5
		movea.l    d0,a1
		movea.l    a3,a0
		jsr        add_icon
		move.l     a0,90(a5)
copy_window_5:
		move.l     94(a5),d0
		beq.s      copy_window_6
		movea.l    d0,a1
		movea.l    a3,a0
		jsr        add_men
		move.l     a0,94(a5)
copy_window_6:
		lea.l      16(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      98(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      102(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      106(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      110(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      114(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      118(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      122(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      126(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      130(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      134(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      138(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      142(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      146(a5),a1
		movea.l    a3,a0
		bsr        copyref
		lea.l      150(a5),a1
		movea.l    a3,a0
		bsr        copyref
		movea.l    158(a5),a1
		movea.l    a3,a0
		jsr        add_string
		move.l     a0,158(a5)
		movea.l    154(a5),a1
		movea.l    a3,a0
		jsr        add_string
		move.l     a0,154(a5)
		movea.l    a4,a0
copy_window_2:
		movem.l    (a7)+,a2-a5
		rts

delref:
		move.l     a2,-(a7)
		movea.l    a1,a2
		move.l     (a1),d0
		beq.s      delref_1
		movea.l    d0,a1
		jsr        del_ref
delref_1:
		movea.l    (a7)+,a2
		rts

del_window:
		movem.l    a2-a5,-(a7)
		movea.l    a0,a4
		movea.l    a1,a2
		subq.w     #1,54(a2)
		move.w     54(a2),d0
		bgt        del_window_1
		movea.l    18(a2),a3
		move.l     a3,d1
		beq.s      del_window_2
		movea.l    4(a3),a5
		movea.l    a3,a0
		moveq.l    #2,d0
		suba.l     a1,a1
		jsr        (a5)
del_window_2:
		movea.l    4(a2),a3
		movea.l    a3,a1
		movea.l    a4,a0
		bsr.w      delref
		lea.l      12(a3),a1
		movea.l    a4,a0
		bsr.w      delref
		lea.l      4(a3),a1
		movea.l    a4,a0
		bsr.w      delref
		lea.l      8(a3),a1
		movea.l    a4,a0
		bsr.w      delref
		move.l     20(a3),d0
		beq.s      del_window_3
		movea.l    d0,a1
		movea.l    a4,a0
		jsr        del_object
del_window_3:
		move.l     24(a3),d0
		beq.s      del_window_4
		movea.l    d0,a1
		movea.l    a4,a0
		jsr        del_object
del_window_4:
		movea.l    74(a3),a1
		movea.l    a4,a0
		jsr        del_string
		movea.l    78(a3),a1
		movea.l    a4,a0
		jsr        del_string
		move.l     90(a3),d0
		beq.s      del_window_5
		movea.l    d0,a1
		movea.l    a4,a0
		jsr        del_icon
del_window_5:
		move.l     94(a3),d0
		beq.s      del_window_6
		movea.l    d0,a1
		movea.l    a4,a0
		jsr        del_men
del_window_6:
		lea.l      16(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      98(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      102(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      106(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      110(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      114(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      118(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      122(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      126(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      130(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      134(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      138(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      142(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      146(a3),a1
		movea.l    a4,a0
		bsr        delref
		lea.l      150(a3),a1
		movea.l    a4,a0
		bsr        delref
		move.l     158(a3),d0
		beq.s      del_window_7
		movea.l    d0,a1
		movea.l    a4,a0
		jsr        del_string
del_window_7:
		move.l     154(a3),d0
		beq.s      del_window_8
		movea.l    d0,a1
		movea.l    a4,a0
		jsr        del_string
del_window_8:
		movea.l    a2,a1
		movea.l    20(a4),a0
		jsr        del_entry
		movea.l    a2,a1
		movea.l    a4,a0
		jsr        objfree
del_window_1:
		movem.l    (a7)+,a2-a5
		rts

new_work:
		move.w     #0x2717,d0
		movea.l    WI_WINDOW+90,a1
		jsr        work_icon
		rts

	.data

protodata:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.b 'DATAS_01',0
		dc.b $00
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
list_data:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.l WI_DATA
		dc.l if_list
		dc.l if_name
		dc.w $2724
		dc.l protodata
		dc.l copy_data
		dc.l del_data
		dc.l new_work
		dc.w $0000
		dc.w $0000
free_data:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.b 'DATAS_01',0
		dc.b $00
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
NameObj:
		dc.w $0000
		dc.w $0000
		dc.l proto_winame
		dc.w $0000
		dc.w $0000
		dc.w $000a
		dc.w $0000
		dc.w $000a
		dc.w $0000
		dc.w $0000
		dc.b 'TEXT_01',0
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
InfoObj:
		dc.w $0000
		dc.w $0000
		dc.l proto_wiinfo
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.b 'TEXT_01',0
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
HelpFileObj:
		dc.w $0000
		dc.w $0000
		dc.l proto_wihelpfile
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.b 'HELPFILE_01',0
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
HelpTitleObj:
		dc.w $0000
		dc.w $0000
		dc.l proto_wihelptitle
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.b 'STGUIDE_01',0
		dc.b $00
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
window_obj:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $6fff
		dc.w $0000
		dc.w $0000
		dc.w $0078
		dc.w $0032
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $ffff
		dc.w $ffff
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $f8f8
		dc.l NameObj
		dc.l InfoObj
		dc.w $0000
		dc.w $0103
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.l HelpFileObj
		dc.l HelpTitleObj
protowindow:
		dc.w $0000
		dc.w $0000
		dc.l window_obj
		dc.w $0000
		dc.w $0000
		dc.w $00a2
		dc.w $0000
		dc.w $00a2
		dc.w $0000
		dc.w $0000
		dc.b 'WINDOW_01',0
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0001
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
list_window:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.l WI_WINDOW
		dc.l wi_list
		dc.l wi_name
		dc.w $2717
		dc.l protowindow
		dc.l copy_window
		dc.l del_window
		dc.l new_work
		dc.w $0000
		dc.w $0000
