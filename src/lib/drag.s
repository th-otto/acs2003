	.globl dotted_xline
dotted_xline:
		lea.l      -14(a7),a7
		move.w     d0,12(a7)
		move.w     d1,10(a7)
		move.w     d2,8(a7)
		movea.l    ACSblk,a0
		move.w     8(a7),d0
		cmp.w      10(a0),d0
		bgt.s      dotted_xline_1
		bra        dotted_xline_2
dotted_xline_1:
		moveq.l    #1,d0
		and.w      8(a7),d0
		beq.s      dotted_xline_3
		cmpi.w     #$AAAA,pattern
		beq.s      dotted_xline_4
		move.w     #$AAAA,pattern
		move.w     #$AAAA,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
dotted_xline_4:
		bra.s      dotted_xline_5
dotted_xline_3:
		cmpi.w     #$5555,pattern
		beq.s      dotted_xline_5
		move.w     #$5555,pattern
		move.w     #$5555,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
dotted_xline_5:
		move.w     12(a7),(a7)
		move.w     10(a7),4(a7)
		move.w     8(a7),d0
		move.w     d0,6(a7)
		move.w     d0,2(a7)
		moveq.l    #7,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_type
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_width
		lea.l      (a7),a0
		moveq.l    #2,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_pline
dotted_xline_2:
		lea.l      14(a7),a7
		rts

	.globl dotted_yline
dotted_yline:
		lea.l      -14(a7),a7
		move.w     d0,12(a7)
		move.w     d1,10(a7)
		move.w     d2,8(a7)
		movea.l    ACSblk,a0
		move.w     8(a7),d0
		cmp.w      8(a0),d0
		bgt.s      dotted_yline_1
		bra        dotted_yline_2
dotted_yline_1:
		move.w     12(a7),d0
		move.w     8(a7),d1
		eor.w      d1,d0
		and.w      #$0001,d0
		beq.s      dotted_yline_3
		cmpi.w     #$AAAA,pattern
		beq.s      dotted_yline_4
		move.w     #$AAAA,pattern
		move.w     #$AAAA,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
dotted_yline_4:
		bra.s      dotted_yline_5
dotted_yline_3:
		cmpi.w     #$5555,pattern
		beq.s      dotted_yline_5
		move.w     #$5555,pattern
		move.w     #$5555,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
dotted_yline_5:
		move.w     12(a7),2(a7)
		move.w     10(a7),6(a7)
		move.w     8(a7),d0
		move.w     d0,4(a7)
		move.w     d0,(a7)
		moveq.l    #7,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_type
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_width
		lea.l      (a7),a0
		moveq.l    #2,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_pline
dotted_yline_2:
		lea.l      14(a7),a7
		rts

	.globl xline2
xline2:
		lea.l      -14(a7),a7
		move.w     d0,12(a7)
		move.w     d1,10(a7)
		move.w     d2,8(a7)
		movea.l    ACSblk,a0
		move.w     8(a7),d0
		cmp.w      10(a0),d0
		bgt.s      xline2_1
		bra        xline2_2
xline2_1:
		moveq.l    #1,d0
		and.w      8(a7),d0
		beq.s      xline2_3
		cmpi.w     #$5555,pattern
		beq.s      xline2_4
		move.w     #$5555,pattern
		move.w     #$5555,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
xline2_4:
		bra.s      xline2_5
xline2_3:
		cmpi.w     #$AAAA,pattern
		beq.s      xline2_5
		move.w     #$AAAA,pattern
		move.w     #$AAAA,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
xline2_5:
		move.w     12(a7),(a7)
		move.w     10(a7),4(a7)
		move.w     8(a7),d0
		move.w     d0,6(a7)
		move.w     d0,2(a7)
		moveq.l    #7,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_type
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_width
		lea.l      (a7),a0
		moveq.l    #2,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_pline
xline2_2:
		lea.l      14(a7),a7
		rts

	.globl yline2
yline2:
		lea.l      -14(a7),a7
		move.w     d0,12(a7)
		move.w     d1,10(a7)
		move.w     d2,8(a7)
		movea.l    ACSblk,a0
		move.w     8(a7),d0
		cmp.w      8(a0),d0
		bgt.s      yline2_1
		bra        yline2_2
yline2_1:
		move.w     12(a7),d0
		move.w     8(a7),d1
		eor.w      d1,d0
		and.w      #$0001,d0
		beq.s      yline2_3
		cmpi.w     #$5555,pattern
		beq.s      yline2_4
		move.w     #$5555,pattern
		move.w     #$5555,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
yline2_4:
		bra.s      yline2_5
yline2_3:
		cmpi.w     #$AAAA,pattern
		beq.s      yline2_5
		move.w     #$AAAA,pattern
		move.w     #$AAAA,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
yline2_5:
		move.w     12(a7),2(a7)
		move.w     10(a7),6(a7)
		move.w     8(a7),d0
		move.w     d0,4(a7)
		move.w     d0,(a7)
		moveq.l    #7,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_type
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_width
		lea.l      (a7),a0
		moveq.l    #2,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_pline
yline2_2:
		lea.l      14(a7),a7
		rts

drag_set:
		lea.l      -18(a7),a7
		clr.w      16(a7)
		bra        drag_set_1
drag_set_9:
		cmpi.w     #$0200,16(a7)
		blt.s      drag_set_2
		bra        drag_set_3
drag_set_2:
		move.w     16(a7),d0
		ext.l      d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    596(a0),a0
		move.w     0(a0,d0.l),12(a7)
		move.w     12(a7),d0
		and.w      #$1000,d0
		beq.s      drag_set_4
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		move.l     24(a0),4(a7)
		andi.w     #$0FFF,12(a7)
		bra.s      drag_set_5
drag_set_4:
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		move.l     20(a0),4(a7)
drag_set_5:
		move.l     _globl,-(a7)
		pea.l      12(a7)
		lea.l      18(a7),a1
		move.w     20(a7),d0
		movea.l    12(a7),a0
		jsr        mt_objc_offset
		addq.w     #8,a7
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		move.w     52(a0),d0
		add.w      d0,10(a7)
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		move.w     54(a0),d0
		add.w      d0,8(a7)
		move.w     12(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    4(a7),a0
		move.w     6(a0,d0.l),d0
		and.w      #$00FF,d0
		move.w     d0,14(a7)
		cmpi.w     #$001F,14(a7)
		beq.s      drag_set_6
		cmpi.w     #$0021,14(a7)
		bne        drag_set_7
drag_set_6:
		move.w     12(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    4(a7),a0
		move.l     12(a0,d0.l),(a7)
		move.w     10(a7),d0
		movea.l    (a7),a0
		add.w      26(a0),d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,0(a0,d1.w)
		move.w     10(a7),d0
		movea.l    (a7),a0
		add.w      18(a0),d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,4(a0,d1.w)
		move.w     10(a7),d0
		movea.l    (a7),a0
		add.w      18(a0),d0
		movea.l    (a7),a0
		add.w      22(a0),d0
		subq.w     #1,d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,8(a0,d1.w)
		move.w     10(a7),d0
		movea.l    (a7),a0
		add.w      26(a0),d0
		movea.l    (a7),a0
		add.w      30(a0),d0
		subq.w     #1,d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,12(a0,d1.w)
		move.w     8(a7),d0
		movea.l    (a7),a0
		add.w      20(a0),d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,2(a0,d1.w)
		move.w     8(a7),d0
		movea.l    (a7),a0
		add.w      28(a0),d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,6(a0,d1.w)
		move.w     8(a7),d0
		movea.l    (a7),a0
		add.w      28(a0),d0
		movea.l    (a7),a0
		add.w      32(a0),d0
		subq.w     #1,d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,10(a0,d1.w)
		move.w     16(a7),d0
		lsl.w      #4,d0
		lea.l      drags,a0
		move.w     #$0001,14(a0,d0.w)
		bra        drag_set_8
drag_set_7:
		move.w     16(a7),d0
		lsl.w      #4,d0
		lea.l      drags,a0
		move.w     10(a7),0(a0,d0.w)
		move.w     16(a7),d0
		lsl.w      #4,d0
		lea.l      drags,a0
		move.w     8(a7),2(a0,d0.w)
		move.w     10(a7),d0
		move.w     12(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    4(a7),a0
		add.w      20(a0,d1.l),d0
		subq.w     #1,d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,4(a0,d1.w)
		move.w     8(a7),d0
		move.w     12(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    4(a7),a0
		add.w      22(a0,d1.l),d0
		subq.w     #1,d0
		move.w     16(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		move.w     d0,6(a0,d1.w)
		move.w     16(a7),d0
		lsl.w      #4,d0
		lea.l      drags,a0
		clr.w      14(a0,d0.w)
drag_set_8:
		addq.w     #1,16(a7)
drag_set_1:
		movea.l    ACSblk,a0
		move.w     16(a7),d0
		cmp.w      582(a0),d0
		blt        drag_set_9
drag_set_3:
		lea.l      18(a7),a7
		rts

drag_draw:
		lea.l      -28(a7),a7
		move.w     d0,26(a7)
		move.w     d1,24(a7)
		moveq.l    #3,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
		clr.w      d2
		clr.w      d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_ends
		movea.l    ACSblk,a0
		move.w     8(a0),(a7)
		movea.l    ACSblk,a0
		move.w     10(a0),2(a7)
		movea.l    ACSblk,a0
		move.w     8(a0),d0
		movea.l    ACSblk,a0
		add.w      12(a0),d0
		subq.w     #1,d0
		move.w     d0,4(a7)
		movea.l    ACSblk,a0
		move.w     10(a0),d0
		movea.l    ACSblk,a0
		add.w      14(a0),d0
		subq.w     #1,d0
		move.w     d0,6(a7)
		lea.l      (a7),a0
		moveq.l    #1,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		movea.l    _globl,a1
		suba.l     a0,a0
		move.w     #$0100,d0
		jsr        mt_graf_mouse
		clr.w      d0
		move.w     d0,22(a7)
		move.w     d0,pattern
		bra        drag_draw_1
drag_draw_9:
		cmpi.w     #$0200,22(a7)
		blt.s      drag_draw_2
		bra        drag_draw_3
drag_draw_2:
		move.w     22(a7),d0
		lsl.w      #4,d0
		lea.l      drags,a0
		cmpi.w     #$0001,14(a0,d0.w)
		bne        drag_draw_4
		move.w     26(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      0(a0,d1.w),d0
		move.w     d0,20(a7)
		move.w     26(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      4(a0,d1.w),d0
		move.w     d0,16(a7)
		move.w     26(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      8(a0,d1.w),d0
		move.w     d0,12(a7)
		move.w     26(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      12(a0,d1.w),d0
		move.w     d0,8(a7)
		move.w     24(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      2(a0,d1.w),d0
		move.w     d0,18(a7)
		move.w     24(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      6(a0,d1.w),d0
		move.w     d0,14(a7)
		move.w     24(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      10(a0,d1.w),d0
		move.w     d0,10(a7)
		movea.l    ACSblk,a0
		move.w     18(a7),d0
		cmp.w      10(a0),d0
		bge.s      drag_draw_5
		moveq.l    #-2,d0
		movea.l    ACSblk,a0
		add.w      10(a0),d0
		move.w     d0,18(a7)
drag_draw_5:
		movea.l    ACSblk,a0
		move.w     14(a7),d0
		cmp.w      10(a0),d0
		bge.s      drag_draw_6
		moveq.l    #-2,d0
		movea.l    ACSblk,a0
		add.w      10(a0),d0
		move.w     d0,14(a7)
drag_draw_6:
		move.w     18(a7),d2
		move.w     12(a7),d1
		move.w     16(a7),d0
		bsr        dotted_xline
		move.w     14(a7),d2
		move.w     16(a7),d1
		move.w     20(a7),d0
		bsr        dotted_xline
		move.w     14(a7),d2
		move.w     8(a7),d1
		move.w     12(a7),d0
		bsr        dotted_xline
		move.w     10(a7),d2
		move.w     8(a7),d1
		move.w     20(a7),d0
		bsr        dotted_xline
		move.w     20(a7),d2
		move.w     10(a7),d1
		move.w     14(a7),d0
		bsr        dotted_yline
		move.w     16(a7),d2
		move.w     14(a7),d1
		move.w     18(a7),d0
		bsr        dotted_yline
		move.w     12(a7),d2
		move.w     14(a7),d1
		move.w     18(a7),d0
		bsr        dotted_yline
		move.w     8(a7),d2
		move.w     10(a7),d1
		move.w     14(a7),d0
		bsr        dotted_yline
		bra        drag_draw_7
drag_draw_4:
		move.w     26(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      0(a0,d1.w),d0
		move.w     d0,20(a7)
		move.w     26(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      4(a0,d1.w),d0
		move.w     d0,16(a7)
		move.w     24(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      2(a0,d1.w),d0
		move.w     d0,18(a7)
		move.w     24(a7),d0
		move.w     22(a7),d1
		lsl.w      #4,d1
		lea.l      drags,a0
		add.w      6(a0,d1.w),d0
		move.w     d0,14(a7)
		movea.l    ACSblk,a0
		move.w     18(a7),d0
		cmp.w      10(a0),d0
		bge.s      drag_draw_8
		moveq.l    #-2,d0
		movea.l    ACSblk,a0
		add.w      10(a0),d0
		move.w     d0,18(a7)
drag_draw_8:
		move.w     18(a7),d2
		move.w     16(a7),d1
		move.w     20(a7),d0
		bsr        dotted_xline
		move.w     14(a7),d2
		move.w     16(a7),d1
		move.w     20(a7),d0
		bsr        dotted_xline
		move.w     20(a7),d2
		move.w     14(a7),d1
		move.w     18(a7),d0
		bsr        dotted_yline
		move.w     16(a7),d2
		move.w     14(a7),d1
		move.w     18(a7),d0
		bsr        dotted_yline
drag_draw_7:
		addq.w     #1,22(a7)
drag_draw_1:
		movea.l    ACSblk,a0
		move.w     22(a7),d0
		cmp.w      582(a0),d0
		blt        drag_draw_9
drag_draw_3:
		movea.l    _globl,a1
		suba.l     a0,a0
		move.w     #$0101,d0
		jsr        mt_graf_mouse
		lea.l      (a7),a0
		clr.w      d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		clr.w      pattern
		lea.l      28(a7),a7
		rts

	.globl Adr_start
Adr_start:
		movea.l    ACSblk,a0
		clr.w      584(a0)
		rts

	.globl Adr_next
Adr_next:
		movea.l    ACSblk,a0
		move.w     584(a0),d0
		movea.l    ACSblk,a0
		cmp.w      582(a0),d0
		blt.s      Adr_next_1
		moveq.l    #-1,d0
		rts
		rts
Adr_next_1:
		movea.l    ACSblk,a0
		move.w     584(a0),d0
		addq.w     #1,584(a0)
		ext.l      d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    596(a0),a0
		move.w     0(a0,d0.l),d0
		nop
		rts

	.globl Adr_add
Adr_add:
		move.l     a2,-(a7)
		lea.l      -14(a7),a7
		move.l     a0,10(a7)
		move.w     d0,8(a7)
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		cmpa.l     10(a7),a0
		beq.s      Adr_add_1
		jsr        Adr_unselect
		movea.l    ACSblk,a0
		move.l     10(a7),576(a0)
Adr_add_1:
		move.w     8(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_add_2
		movea.l    10(a7),a0
		move.l     24(a0),(a7)
		bra.s      Adr_add_3
Adr_add_2:
		movea.l    10(a7),a0
		move.l     20(a0),(a7)
Adr_add_3:
		clr.w      4(a7)
		bra.s      Adr_add_4
Adr_add_7:
		move.w     4(a7),d0
		ext.l      d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    596(a0),a0
		move.w     0(a0,d0.l),d0
		cmp.w      8(a7),d0
		bne.s      Adr_add_5
		bra        Adr_add_6
Adr_add_5:
		addq.w     #1,4(a7)
Adr_add_4:
		movea.l    ACSblk,a0
		move.w     4(a7),d0
		cmp.w      582(a0),d0
		blt.s      Adr_add_7
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		movea.l    ACSblk,a0
		cmp.w      580(a0),d0
		bge.s      Adr_add_6
		moveq.l    #1,d1
		move.w     8(a7),d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		movea.l    (a7),a0
		or.w       10(a0,d0.l),d1
		move.w     8(a7),d0
		movea.l    10(a7),a0
		movea.l    10(a7),a1
		movea.l    102(a1),a1
		jsr        (a1)
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		addq.w     #1,582(a0)
		ext.l      d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    596(a0),a0
		move.w     8(a7),0(a0,d0.l)
		move.w     8(a7),6(a7)
		lea.l      6(a7),a1
		moveq.l    #5,d0
		movea.l    10(a7),a0
		movea.l    10(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
Adr_add_6:
		lea.l      14(a7),a7
		movea.l    (a7)+,a2
		rts

	.globl Adr_del
Adr_del:
		move.l     a2,-(a7)
		lea.l      -22(a7),a7
		move.l     a0,18(a7)
		move.w     d0,16(a7)
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		cmpa.l     18(a7),a0
		beq.s      Adr_del_1
		bra        Adr_del_2
Adr_del_1:
		move.w     16(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_del_3
		movea.l    18(a7),a0
		move.l     24(a0),4(a7)
		bra.s      Adr_del_4
Adr_del_3:
		movea.l    18(a7),a0
		move.l     20(a0),4(a7)
Adr_del_4:
		movea.l    ACSblk,a0
		move.w     582(a0),12(a7)
		movea.l    ACSblk,a0
		move.l     596(a0),8(a7)
		bra        Adr_del_5
Adr_del_10:
		movea.l    8(a7),a0
		move.w     (a0),d0
		cmp.w      16(a7),d0
		bne        Adr_del_6
		move.w     16(a7),d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		movea.l    4(a7),a0
		move.w     10(a0,d0.l),d1
		and.w      #$FFFE,d1
		move.w     16(a7),d0
		movea.l    18(a7),a0
		movea.l    18(a7),a1
		movea.l    102(a1),a1
		jsr        (a1)
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		sub.w      12(a7),d0
		movea.l    ACSblk,a0
		cmp.w      584(a0),d0
		bge.s      Adr_del_7
		movea.l    ACSblk,a0
		subq.w     #1,584(a0)
Adr_del_7:
		movea.l    ACSblk,a0
		subq.w     #1,582(a0)
		move.w     12(a7),d0
		lsl.w      #4,d0
		lea.l      drags,a0
		adda.w     d0,a0
		move.l     a0,(a7)
		subq.w     #1,12(a7)
		bra.s      Adr_del_8
Adr_del_9:
		movea.l    (a7),a0
		movea.l    (a7),a1
		move.w     16(a0),(a1)
		movea.l    (a7),a0
		movea.l    (a7),a1
		move.w     18(a0),2(a1)
		movea.l    (a7),a0
		movea.l    (a7),a1
		move.w     20(a0),4(a1)
		movea.l    (a7),a0
		movea.l    (a7),a1
		move.w     22(a0),6(a1)
		movea.l    (a7),a0
		movea.l    (a7),a1
		move.w     24(a0),8(a1)
		movea.l    (a7),a0
		movea.l    (a7),a1
		move.w     26(a0),10(a1)
		movea.l    (a7),a0
		movea.l    (a7),a1
		move.w     28(a0),12(a1)
		movea.l    (a7),a0
		movea.l    (a7),a1
		move.w     30(a0),14(a1)
		movea.l    8(a7),a0
		movea.l    8(a7),a1
		move.w     2(a0),(a1)
		subq.w     #1,12(a7)
		subi.l     #$00000010,(a7)
		addq.l     #2,8(a7)
Adr_del_8:
		move.w     12(a7),d0
		bgt.s      Adr_del_9
		move.w     16(a7),14(a7)
		lea.l      14(a7),a1
		moveq.l    #6,d0
		movea.l    18(a7),a0
		movea.l    18(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
		bra.s      Adr_del_2
Adr_del_6:
		subq.w     #1,12(a7)
		addq.l     #2,8(a7)
Adr_del_5:
		move.w     12(a7),d0
		bgt        Adr_del_10
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		bne.s      Adr_del_2
		movea.l    ACSblk,a0
		clr.l      576(a0)
Adr_del_2:
		lea.l      22(a7),a7
		movea.l    (a7)+,a2
		rts

	.globl Adr_unselect
Adr_unselect:
		move.l     a2,-(a7)
		subq.w     #8,a7
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		bgt.s      Adr_unselect_1
		bra        Adr_unselect_2
Adr_unselect_1:
		movea.l    ACSblk,a0
		move.l     576(a0),4(a7)
		clr.w      2(a7)
		bra        Adr_unselect_3
Adr_unselect_6:
		move.w     2(a7),d0
		ext.l      d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    596(a0),a0
		move.w     0(a0,d0.l),(a7)
		move.w     (a7),d0
		and.w      #$1000,d0
		beq.s      Adr_unselect_4
		move.w     (a7),d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		movea.l    4(a7),a0
		movea.l    24(a0),a0
		move.w     10(a0,d0.l),d1
		and.w      #$FFFE,d1
		move.w     (a7),d0
		movea.l    4(a7),a0
		movea.l    4(a7),a1
		movea.l    102(a1),a1
		jsr        (a1)
		bra.s      Adr_unselect_5
Adr_unselect_4:
		move.w     (a7),d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		movea.l    4(a7),a0
		movea.l    20(a0),a0
		move.w     10(a0,d0.l),d1
		and.w      #$FFFE,d1
		move.w     (a7),d0
		movea.l    4(a7),a0
		movea.l    4(a7),a1
		movea.l    102(a1),a1
		jsr        (a1)
Adr_unselect_5:
		addq.w     #1,2(a7)
Adr_unselect_3:
		movea.l    ACSblk,a0
		move.w     2(a7),d0
		cmp.w      582(a0),d0
		blt        Adr_unselect_6
		movea.l    ACSblk,a0
		clr.w      582(a0)
		movea.l    ACSblk,a0
		clr.l      576(a0)
		suba.l     a1,a1
		moveq.l    #6,d0
		movea.l    4(a7),a0
		movea.l    4(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
Adr_unselect_2:
		addq.w     #8,a7
		movea.l    (a7)+,a2
		rts

rect_find:
		lea.l      -42(a7),a7
		move.l     a0,38(a7)
		move.l     a1,34(a7)
		move.w     d0,32(a7)
		move.w     d1,30(a7)
		move.w     d2,28(a7)
		move.w     32(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    34(a7),a0
		move.w     2(a0,d0.l),22(a7)
		bpl.s      rect_find_1
		bra        rect_find_2
rect_find_1:
		bra        rect_find_3
rect_find_20:
		move.w     22(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    34(a7),a0
		adda.l     d0,a0
		move.l     a0,24(a7)
		move.w     30(a7),d0
		movea.l    24(a7),a0
		add.w      16(a0),d0
		move.w     d0,20(a7)
		movea.l    24(a7),a0
		add.w      20(a0),d0
		subq.w     #1,d0
		move.w     d0,18(a7)
		move.w     28(a7),d0
		movea.l    24(a7),a0
		add.w      18(a0),d0
		move.w     d0,16(a7)
		movea.l    24(a7),a0
		add.w      22(a0),d0
		subq.w     #1,d0
		move.w     d0,14(a7)
		movea.l    24(a7),a0
		move.w     6(a0),d0
		and.w      #$00FF,d0
		move.w     d0,12(a7)
		cmp.w      #$001F,d0
		beq.s      rect_find_4
		cmpi.w     #$0021,12(a7)
		bne        rect_find_5
rect_find_4:
		movea.l    24(a7),a0
		move.l     12(a0),(a7)
		movea.l    (a7),a0
		move.w     18(a0),d0
		add.w      d0,20(a7)
		move.w     20(a7),d0
		movea.l    (a7),a0
		add.w      22(a0),d0
		subq.w     #1,d0
		move.w     d0,18(a7)
		movea.l    (a7),a0
		move.w     20(a0),d0
		add.w      d0,16(a7)
		move.w     16(a7),d0
		movea.l    (a7),a0
		add.w      24(a0),d0
		subq.w     #1,d0
		move.w     d0,14(a7)
		move.w     30(a7),d0
		movea.l    24(a7),a0
		add.w      16(a0),d0
		movea.l    (a7),a0
		add.w      26(a0),d0
		move.w     d0,10(a7)
		movea.l    (a7),a0
		add.w      30(a0),d0
		subq.w     #1,d0
		move.w     d0,8(a7)
		move.w     28(a7),d0
		movea.l    24(a7),a0
		add.w      18(a0),d0
		movea.l    (a7),a0
		add.w      28(a0),d0
		move.w     d0,6(a7)
		movea.l    (a7),a0
		add.w      32(a0),d0
		subq.w     #1,d0
		move.w     d0,4(a7)
		bra.s      rect_find_6
rect_find_5:
		moveq.l    #-1,d0
		move.w     d0,4(a7)
		move.w     d0,6(a7)
		move.w     d0,8(a7)
		move.w     d0,10(a7)
rect_find_6:
		movea.l    46(a7),a0
		move.w     14(a7),d0
		cmp.w      2(a0),d0
		blt.s      rect_find_7
		movea.l    46(a7),a0
		move.w     2(a0),d0
		movea.l    46(a7),a0
		add.w      6(a0),d0
		subq.w     #1,d0
		move.w     16(a7),d1
		cmp.w      d0,d1
		bgt.s      rect_find_7
		movea.l    46(a7),a0
		move.w     18(a7),d0
		cmp.w      (a0),d0
		blt.s      rect_find_7
		movea.l    46(a7),a0
		move.w     (a0),d0
		movea.l    46(a7),a0
		add.w      4(a0),d0
		subq.w     #1,d0
		move.w     20(a7),d1
		cmp.w      d0,d1
		ble.s      rect_find_8
rect_find_7:
		movea.l    46(a7),a0
		move.w     4(a7),d0
		cmp.w      2(a0),d0
		blt        rect_find_9
		movea.l    46(a7),a0
		move.w     2(a0),d0
		movea.l    46(a7),a0
		add.w      6(a0),d0
		subq.w     #1,d0
		move.w     6(a7),d1
		cmp.w      d0,d1
		bgt.w      rect_find_9
		movea.l    46(a7),a0
		move.w     8(a7),d0
		cmp.w      (a0),d0
		blt.s      rect_find_9
		movea.l    46(a7),a0
		move.w     (a0),d0
		movea.l    46(a7),a0
		add.w      4(a0),d0
		subq.w     #1,d0
		move.w     10(a7),d1
		cmp.w      d0,d1
		bgt.s      rect_find_9
rect_find_8:
		movea.l    24(a7),a0
		move.w     8(a0),d0
		and.w      #$2000,d0
		beq.s      rect_find_10
		move.w     #$0080,d0
		movea.l    24(a7),a0
		and.w      8(a0),d0
		bne.s      rect_find_10
		moveq.l    #8,d0
		movea.l    24(a7),a0
		and.w      10(a0),d0
		bne.s      rect_find_10
		movea.l    38(a7),a0
		movea.l    34(a7),a1
		cmpa.l     20(a0),a1
		bne.s      rect_find_11
		move.w     22(a7),d0
		movea.l    38(a7),a0
		bsr        Adr_add
		bra.s      rect_find_10
rect_find_11:
		move.w     22(a7),d0
		or.w       #$1000,d0
		movea.l    38(a7),a0
		bsr        Adr_add
rect_find_10:
		bra        rect_find_12
rect_find_9:
		moveq.l    #1,d0
		move.w     22(a7),d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    34(a7),a0
		and.w      10(a0,d1.l),d0
		bne.s      rect_find_13
		bra.s      rect_find_12
rect_find_13:
		movea.l    50(a7),a0
		move.l     20(a0),d0
		beq.s      rect_find_14
		clr.w      12(a7)
		bra.s      rect_find_15
rect_find_17:
		move.w     12(a7),d0
		ext.l      d0
		add.l      d0,d0
		movea.l    50(a7),a0
		movea.l    20(a0),a0
		move.w     0(a0,d0.l),d0
		and.w      #$0FFF,d0
		cmp.w      22(a7),d0
		bne.s      rect_find_16
		bra.s      rect_find_12
rect_find_16:
		addq.w     #1,12(a7)
rect_find_15:
		movea.l    50(a7),a0
		move.w     12(a7),d0
		cmp.w      6(a0),d0
		blt.s      rect_find_17
rect_find_14:
		movea.l    38(a7),a0
		movea.l    34(a7),a1
		cmpa.l     20(a0),a1
		bne.s      rect_find_18
		move.w     22(a7),d0
		movea.l    38(a7),a0
		bsr        Adr_del
		bra.s      rect_find_12
rect_find_18:
		move.w     22(a7),d0
		or.w       #$1000,d0
		movea.l    38(a7),a0
		bsr        Adr_del
rect_find_12:
		move.w     #$0080,d0
		movea.l    24(a7),a0
		and.w      8(a0),d0
		bne.s      rect_find_19
		move.l     50(a7),-(a7)
		move.l     50(a7),-(a7)
		move.w     24(a7),d2
		move.w     28(a7),d1
		move.w     30(a7),d0
		movea.l    42(a7),a1
		movea.l    46(a7),a0
		bsr        rect_find
		addq.w     #8,a7
rect_find_19:
		movea.l    24(a7),a0
		move.w     (a0),22(a7)
rect_find_3:
		move.w     22(a7),d0
		cmp.w      32(a7),d0
		bne        rect_find_20
rect_find_2:
		lea.l      42(a7),a7
		rts

	.globl Adr_box
Adr_box:
		move.l     a2,-(a7)
		lea.l      -84(a7),a7
		move.w     d0,82(a7)
		move.w     d1,80(a7)
		clr.w      50(a7)
		movea.l    _globl,a0
		move.w     80(a7),d1
		move.w     82(a7),d0
		jsr        mt_wind_find
		jsr        Awi_wid
		move.l     a0,42(a7)
		bne.s      Adr_box_1
		bra        Adr_box_2
Adr_box_1:
		moveq.l    #3,d0
		movea.l    ACSblk,a0
		and.w      614(a0),d0
		bne.s      Adr_box_3
		bsr        Adr_unselect
		clr.l      20(a7)
		clr.w      54(a7)
		bra.s      Adr_box_4
Adr_box_3:
		movea.l    ACSblk,a0
		move.w     580(a0),d0
		ext.l      d0
		add.l      d0,d0
		jsr        Ax_malloc
		move.l     a0,20(a7)
		bne.s      Adr_box_5
		bra        Adr_box_2
Adr_box_5:
		movea.l    ACSblk,a0
		move.w     580(a0),d1
		ext.l      d1
		add.l      d1,d1
		clr.w      d0
		movea.l    20(a7),a0
		jsr        memset
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		ext.l      d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    596(a0),a1
		movea.l    20(a7),a0
		jsr        memcpy
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		move.w     d0,6(a7)
		move.w     d0,54(a7)
Adr_box_4:
		movea.l    ACSblk,a0
		move.l     42(a7),576(a0)
		movea.l    42(a7),a0
		move.w     52(a0),56(a7)
		movea.l    42(a7),a0
		move.w     54(a0),58(a7)
		movea.l    42(a7),a0
		move.w     56(a0),60(a7)
		movea.l    42(a7),a0
		move.w     58(a0),62(a7)
		movea.l    42(a7),a0
		move.l     24(a0),d0
		beq.s      Adr_box_6
		movea.l    42(a7),a0
		move.w     80(a7),d0
		cmp.w      54(a0),d0
		blt.s      Adr_box_7
Adr_box_6:
		clr.w      52(a7)
		bra.s      Adr_box_8
Adr_box_7:
		move.w     #$0001,52(a7)
		movea.l    42(a7),a0
		movea.l    24(a0),a0
		move.w     18(a0),d0
		add.w      d0,58(a7)
		movea.l    42(a7),a0
		movea.l    24(a0),a0
		move.w     22(a0),62(a7)
Adr_box_8:
		move.w     82(a7),d0
		move.w     d0,32(a7)
		move.w     d0,36(a7)
		move.w     d0,72(a7)
		move.w     d0,64(a7)
		move.w     80(a7),d0
		move.w     d0,30(a7)
		move.w     d0,34(a7)
		move.w     d0,74(a7)
		move.w     d0,66(a7)
		clr.w      d0
		move.w     d0,78(a7)
		move.w     d0,70(a7)
		move.w     d0,76(a7)
		move.w     d0,68(a7)
		suba.l     a1,a1
		moveq.l    #20,d0
		movea.l    42(a7),a0
		movea.l    42(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		lea.l      68(a0),a0
		jsr        Amo_new
		moveq.l    #3,d0
		jsr        Awi_update
Adr_box_40:
		jsr        Amo_hide
		moveq.l    #3,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
		move.w     74(a7),d2
		move.w     72(a7),d1
		add.w      76(a7),d1
		subq.w     #1,d1
		move.w     d1,40(a7)
		move.w     72(a7),d0
		bsr        dotted_xline
		move.w     72(a7),d0
		cmp.w      40(a7),d0
		beq.s      Adr_box_9
		move.w     74(a7),d2
		add.w      78(a7),d2
		subq.w     #1,d2
		move.w     d2,38(a7)
		move.w     40(a7),d1
		move.w     72(a7),d0
		bsr        dotted_xline
Adr_box_9:
		move.w     72(a7),d2
		move.w     38(a7),d1
		move.w     74(a7),d0
		bsr        dotted_yline
		move.w     74(a7),d0
		cmp.w      38(a7),d0
		beq.s      Adr_box_10
		move.w     40(a7),d2
		move.w     38(a7),d1
		move.w     74(a7),d0
		bsr        dotted_yline
Adr_box_10:
		jsr        Amo_show
Adr_box_12:
		pea.l      24(a7)
		lea.l      30(a7),a1
		lea.l      32(a7),a0
		movea.l    ACSblk,a2
		move.w     16(a2),d0
		jsr        vq_mouse
		addq.w     #4,a7
		move.w     50(a7),d0
		bne.s      Adr_box_11
		move.w     28(a7),d0
		beq.s      Adr_box_11
		move.w     26(a7),d0
		cmp.w      32(a7),d0
		bne.s      Adr_box_11
		move.w     24(a7),d0
		cmp.w      30(a7),d0
		beq.s      Adr_box_12
Adr_box_11:
		jsr        Amo_hide
		moveq.l    #3,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
		move.w     74(a7),d2
		move.w     40(a7),d1
		move.w     72(a7),d0
		bsr        dotted_xline
		move.w     72(a7),d0
		cmp.w      40(a7),d0
		beq.s      Adr_box_13
		move.w     74(a7),d2
		add.w      78(a7),d2
		subq.w     #1,d2
		move.w     40(a7),d1
		move.w     72(a7),d0
		bsr        dotted_xline
Adr_box_13:
		move.w     72(a7),d2
		move.w     38(a7),d1
		move.w     74(a7),d0
		bsr        dotted_yline
		move.w     74(a7),d0
		cmp.w      38(a7),d0
		beq.s      Adr_box_14
		move.w     40(a7),d2
		move.w     38(a7),d1
		move.w     74(a7),d0
		bsr        dotted_yline
Adr_box_14:
		jsr        Amo_show
		move.w     28(a7),d0
		beq        Adr_box_15
		move.w     26(a7),d0
		move.w     d0,32(a7)
		move.w     36(a7),d1
		cmp.w      d0,d1
		bge.s      Adr_box_16
		move.w     36(a7),d0
		bra.s      Adr_box_17
Adr_box_16:
		move.w     26(a7),d0
		move.w     d0,32(a7)
Adr_box_17:
		move.w     d0,64(a7)
		move.w     24(a7),d0
		move.w     d0,30(a7)
		move.w     34(a7),d1
		cmp.w      d0,d1
		bge.s      Adr_box_18
		move.w     34(a7),d0
		bra.s      Adr_box_19
Adr_box_18:
		move.w     24(a7),d0
		move.w     d0,30(a7)
Adr_box_19:
		move.w     d0,66(a7)
		move.w     32(a7),d0
		sub.w      36(a7),d0
		move.w     d0,68(a7)
		bpl.s      Adr_box_20
		move.w     68(a7),d0
		neg.w      d0
		move.w     d0,68(a7)
Adr_box_20:
		addq.w     #1,68(a7)
		move.w     30(a7),d0
		sub.w      34(a7),d0
		move.w     d0,70(a7)
		bpl.s      Adr_box_21
		move.w     70(a7),d0
		neg.w      d0
		move.w     d0,70(a7)
Adr_box_21:
		addq.w     #1,70(a7)
		clr.w      50(a7)
		move.w     52(a7),d0
		bne        Adr_box_22
		movea.l    42(a7),a0
		move.w     52(a0),46(a7)
		movea.l    42(a7),a0
		move.w     60(a0),d0
		ble        Adr_box_23
		move.w     32(a7),d0
		cmp.w      46(a7),d0
		bge        Adr_box_23
		movea.l    42(a7),a0
		move.w     34(a0),d0
		and.w      #$0A00,d0
		beq        Adr_box_23
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		move.w     16(a0),48(a7)
		move.w     46(a7),d1
		sub.w      32(a7),d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     64(a0),d1
		ext.l      d1
		jsr        _ldiv
		movea.l    42(a7),a0
		move.w     60(a0),d1
		sub.w      d0,d1
		subq.w     #1,d1
		bge.s      Adr_box_24
		moveq.l    #1,d0
		bra.s      Adr_box_25
Adr_box_24:
		move.w     46(a7),d1
		sub.w      32(a7),d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     64(a0),d1
		ext.l      d1
		jsr        _ldiv
		movea.l    42(a7),a0
		move.w     d0,-(a7)
		move.w     60(a0),d0
		sub.w      (a7)+,d0
Adr_box_25:
		move.w     d0,40(a7)
		movea.l    42(a7),a0
		move.w     60(a0),d0
		sub.w      40(a7),d0
		movea.l    42(a7),a0
		move.w     72(a0),d1
		not.w      d1
		and.w      #$00FF,d1
		addq.w     #1,d1
		cmp.w      d1,d0
		bge.s      Adr_box_26
		moveq.l    #1,d1
		moveq.l    #6,d0
		movea.l    42(a7),a0
		movea.l    42(a7),a1
		movea.l    122(a1),a1
		jsr        (a1)
		bra.s      Adr_box_27
Adr_box_26:
		move.w     40(a7),d0
		movea.l    42(a7),a0
		movea.l    42(a7),a1
		movea.l    126(a1),a1
		jsr        (a1)
Adr_box_27:
		move.w     48(a7),d0
		neg.w      d0
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		add.w      16(a0),d0
		move.w     d0,38(a7)
		add.w      d0,68(a7)
		move.w     38(a7),d0
		sub.w      d0,64(a7)
		move.w     38(a7),d0
		add.w      d0,36(a7)
		move.w     #$0001,50(a7)
Adr_box_23:
		movea.l    42(a7),a0
		move.w     54(a0),46(a7)
		movea.l    42(a7),a0
		move.w     62(a0),d0
		ble        Adr_box_28
		move.w     30(a7),d0
		cmp.w      46(a7),d0
		bge        Adr_box_28
		movea.l    42(a7),a0
		move.w     34(a0),d0
		and.w      #$0140,d0
		beq        Adr_box_28
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		move.w     18(a0),48(a7)
		move.w     46(a7),d1
		sub.w      30(a7),d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     66(a0),d1
		ext.l      d1
		jsr        _ldiv
		movea.l    42(a7),a0
		move.w     62(a0),d1
		sub.w      d0,d1
		subq.w     #1,d1
		bge.s      Adr_box_29
		moveq.l    #1,d0
		bra.s      Adr_box_30
Adr_box_29:
		move.w     46(a7),d1
		sub.w      30(a7),d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     66(a0),d1
		ext.l      d1
		jsr        _ldiv
		movea.l    42(a7),a0
		move.w     d0,-(a7)
		move.w     62(a0),d0
		sub.w      (a7)+,d0
Adr_box_30:
		move.w     d0,40(a7)
		movea.l    42(a7),a0
		move.w     62(a0),d0
		sub.w      40(a7),d0
		movea.l    42(a7),a0
		move.w     72(a0),d1
		not.w      d1
		asr.w      #8,d1
		and.w      #$00FF,d1
		addq.w     #1,d1
		cmp.w      d1,d0
		bge.s      Adr_box_31
		moveq.l    #1,d1
		moveq.l    #2,d0
		movea.l    42(a7),a0
		movea.l    42(a7),a1
		movea.l    122(a1),a1
		jsr        (a1)
		bra.s      Adr_box_32
Adr_box_31:
		move.w     40(a7),d0
		movea.l    42(a7),a0
		movea.l    42(a7),a1
		movea.l    130(a1),a1
		jsr        (a1)
Adr_box_32:
		move.w     48(a7),d0
		neg.w      d0
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		add.w      18(a0),d0
		move.w     d0,38(a7)
		add.w      d0,70(a7)
		move.w     38(a7),d0
		sub.w      d0,66(a7)
		move.w     38(a7),d0
		add.w      d0,34(a7)
		move.w     #$0001,50(a7)
Adr_box_28:
		movea.l    42(a7),a0
		move.w     52(a0),d0
		movea.l    42(a7),a0
		add.w      56(a0),d0
		subq.w     #1,d0
		move.w     d0,46(a7)
		movea.l    42(a7),a0
		cmpi.w     #$03E8,60(a0)
		bge        Adr_box_33
		move.w     46(a7),d0
		cmp.w      32(a7),d0
		bge        Adr_box_33
		movea.l    42(a7),a0
		move.w     34(a0),d0
		and.w      #$0C00,d0
		beq        Adr_box_33
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		move.w     16(a0),48(a7)
		move.w     32(a7),d1
		sub.w      46(a7),d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     64(a0),d1
		ext.l      d1
		jsr        _ldiv
		movea.l    42(a7),a0
		add.w      60(a0),d0
		cmp.w      #$03E8,d0
		ble.s      Adr_box_34
		move.w     #$03E8,d0
		bra.s      Adr_box_35
Adr_box_34:
		move.w     32(a7),d1
		sub.w      46(a7),d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     64(a0),d1
		ext.l      d1
		jsr        _ldiv
		movea.l    42(a7),a0
		add.w      60(a0),d0
Adr_box_35:
		move.w     d0,40(a7)
		move.w     40(a7),d0
		movea.l    42(a7),a0
		movea.l    42(a7),a1
		movea.l    126(a1),a1
		jsr        (a1)
		move.w     48(a7),d0
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		sub.w      16(a0),d0
		move.w     d0,38(a7)
		sub.w      d0,64(a7)
		move.w     38(a7),d0
		add.w      d0,68(a7)
		move.w     38(a7),d0
		sub.w      d0,36(a7)
		move.w     #$0001,50(a7)
Adr_box_33:
		movea.l    42(a7),a0
		move.w     54(a0),d0
		movea.l    42(a7),a0
		add.w      58(a0),d0
		subq.w     #1,d0
		move.w     d0,46(a7)
		movea.l    42(a7),a0
		cmpi.w     #$03E8,62(a0)
		bge        Adr_box_22
		move.w     46(a7),d0
		cmp.w      30(a7),d0
		bge        Adr_box_22
		movea.l    42(a7),a0
		move.w     34(a0),d0
		and.w      #$0180,d0
		beq        Adr_box_22
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		move.w     18(a0),48(a7)
		move.w     30(a7),d1
		sub.w      46(a7),d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     66(a0),d1
		ext.l      d1
		jsr        _ldiv
		movea.l    42(a7),a0
		add.w      62(a0),d0
		cmp.w      #$03E8,d0
		ble.s      Adr_box_36
		move.w     #$03E8,d0
		bra.s      Adr_box_37
Adr_box_36:
		move.w     30(a7),d1
		sub.w      46(a7),d1
		addq.w     #1,d1
		ext.l      d1
		move.l     d1,d0
		lsl.l      #5,d0
		sub.l      d1,d0
		lsl.l      #2,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     66(a0),d1
		ext.l      d1
		jsr        _ldiv
		movea.l    42(a7),a0
		add.w      62(a0),d0
Adr_box_37:
		move.w     d0,40(a7)
		move.w     40(a7),d0
		movea.l    42(a7),a0
		movea.l    42(a7),a1
		movea.l    130(a1),a1
		jsr        (a1)
		move.w     48(a7),d0
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		sub.w      18(a0),d0
		move.w     d0,38(a7)
		sub.w      d0,66(a7)
		move.w     38(a7),d0
		add.w      d0,70(a7)
		move.w     38(a7),d0
		sub.w      d0,34(a7)
		move.w     #$0001,50(a7)
Adr_box_22:
		move.w     64(a7),72(a7)
		move.w     66(a7),74(a7)
		move.w     68(a7),76(a7)
		move.w     70(a7),78(a7)
		lea.l      56(a7),a1
		lea.l      72(a7),a0
		jsr        intersect
		move.w     52(a7),d0
		beq.s      Adr_box_38
		pea.l      (a7)
		pea.l      68(a7)
		movea.l    50(a7),a0
		move.w     54(a0),d2
		movea.l    50(a7),a0
		movea.l    24(a0),a0
		add.w      18(a0),d2
		movea.l    50(a7),a0
		move.w     52(a0),d1
		clr.w      d0
		movea.l    50(a7),a0
		movea.l    24(a0),a1
		movea.l    50(a7),a0
		bsr        rect_find
		addq.w     #8,a7
		bra.s      Adr_box_39
Adr_box_38:
		pea.l      (a7)
		pea.l      68(a7)
		movea.l    50(a7),a0
		move.w     54(a0),d2
		movea.l    50(a7),a0
		movea.l    20(a0),a0
		add.w      18(a0),d2
		movea.l    50(a7),a0
		move.w     52(a0),d1
		movea.l    50(a7),a0
		movea.l    20(a0),a0
		add.w      16(a0),d1
		clr.w      d0
		movea.l    50(a7),a0
		movea.l    20(a0),a1
		movea.l    50(a7),a0
		bsr        rect_find
		addq.w     #8,a7
Adr_box_39:
		movea.l    ACSblk,a0
		move.w     54(a7),d0
		cmp.w      582(a0),d0
		beq.s      Adr_box_15
		suba.l     a1,a1
		moveq.l    #21,d0
		movea.l    42(a7),a0
		movea.l    42(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
		movea.l    ACSblk,a0
		move.w     582(a0),54(a7)
Adr_box_15:
		move.w     28(a7),d0
		bne        Adr_box_40
		moveq.l    #2,d0
		jsr        Awi_update
		suba.l     a1,a1
		moveq.l    #22,d0
		movea.l    42(a7),a0
		movea.l    42(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
		move.l     20(a7),d0
		beq.s      Adr_box_41
		movea.l    20(a7),a0
		jsr        Ax_ifree
Adr_box_41:
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		lea.l      56(a0),a0
		jsr        Amo_new
Adr_box_2:
		lea.l      84(a7),a7
		movea.l    (a7)+,a2
		rts

Adr_find0:
		lea.l      -46(a7),a7
		move.l     a0,42(a7)
		move.w     d0,40(a7)
		move.w     d1,38(a7)
		move.w     d2,36(a7)
		move.w     40(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		adda.l     d0,a0
		move.l     a0,20(a7)
		move.w     #$0080,d0
		movea.l    20(a7),a0
		and.w      8(a0),d0
		beq.s      Adr_find0_1
		moveq.l    #-1,d0
		bra        Adr_find0_2
Adr_find0_1:
		moveq.l    #8,d0
		movea.l    20(a7),a0
		and.w      10(a0),d0
		beq.s      Adr_find0_3
		moveq.l    #-1,d0
		bra        Adr_find0_2
Adr_find0_3:
		movea.l    20(a7),a0
		move.w     6(a0),d0
		and.w      #$00FF,d0
		move.w     d0,28(a7)
		cmp.w      #$001F,d0
		beq.s      Adr_find0_4
		cmpi.w     #$0021,28(a7)
		bne        Adr_find0_5
Adr_find0_4:
		movea.l    20(a7),a0
		move.l     12(a0),(a7)
		movea.l    20(a7),a0
		move.w     16(a0),d0
		movea.l    (a7),a0
		add.w      18(a0),d0
		move.w     d0,12(a7)
		movea.l    20(a7),a0
		move.w     18(a0),d0
		movea.l    (a7),a0
		add.w      20(a0),d0
		move.w     d0,14(a7)
		movea.l    (a7),a0
		move.w     22(a0),16(a7)
		movea.l    (a7),a0
		move.w     24(a0),18(a7)
		movea.l    20(a7),a0
		move.w     16(a0),d0
		movea.l    (a7),a0
		add.w      26(a0),d0
		move.w     d0,4(a7)
		movea.l    20(a7),a0
		move.w     18(a0),d0
		movea.l    (a7),a0
		add.w      28(a0),d0
		move.w     d0,6(a7)
		movea.l    (a7),a0
		move.w     30(a0),8(a7)
		movea.l    (a7),a0
		move.w     32(a0),10(a7)
		move.w     50(a7),d1
		move.w     36(a7),d0
		lea.l      12(a7),a0
		jsr        Aob_within
		tst.w      d0
		bne.s      Adr_find0_6
		move.w     50(a7),d1
		move.w     36(a7),d0
		lea.l      4(a7),a0
		jsr        Aob_within
		tst.w      d0
		bne.s      Adr_find0_6
		moveq.l    #-1,d0
		bra        Adr_find0_2
Adr_find0_6:
		bra.s      Adr_find0_7
Adr_find0_5:
		movea.l    20(a7),a0
		move.w     16(a0),12(a7)
		movea.l    20(a7),a0
		move.w     18(a0),14(a7)
		movea.l    20(a7),a0
		move.w     20(a0),16(a7)
		movea.l    20(a7),a0
		move.w     22(a0),18(a7)
		move.w     50(a7),d1
		move.w     36(a7),d0
		lea.l      12(a7),a0
		jsr        Aob_within
		tst.w      d0
		bne.s      Adr_find0_7
		moveq.l    #-1,d0
		bra        Adr_find0_2
Adr_find0_7:
		movea.l    20(a7),a0
		move.w     2(a0),30(a7)
		move.w     30(a7),d0
		bmi        Adr_find0_8
		move.w     38(a7),d0
		ble        Adr_find0_8
		move.w     36(a7),d0
		movea.l    20(a7),a0
		sub.w      16(a0),d0
		move.w     d0,34(a7)
		move.w     50(a7),d0
		movea.l    20(a7),a0
		sub.w      18(a0),d0
		move.w     d0,32(a7)
		move.w     #$FFFF,24(a7)
Adr_find0_10:
		move.w     32(a7),-(a7)
		move.w     36(a7),d2
		moveq.l    #-1,d1
		add.w      40(a7),d1
		move.w     32(a7),d0
		movea.l    44(a7),a0
		bsr        Adr_find0
		addq.w     #2,a7
		move.w     d0,26(a7)
		move.w     26(a7),d0
		bmi.s      Adr_find0_9
		move.w     26(a7),24(a7)
Adr_find0_9:
		move.w     30(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		move.w     0(a0,d0.l),30(a7)
		move.w     30(a7),d0
		cmp.w      40(a7),d0
		bne.s      Adr_find0_10
		move.w     24(a7),d0
		bmi.s      Adr_find0_8
		move.w     24(a7),d0
		bra.s      Adr_find0_2
Adr_find0_8:
		move.w     40(a7),d0
Adr_find0_2:
		lea.l      46(a7),a7
		rts

	.globl Adr_find
Adr_find:
		lea.l      -16(a7),a7
		move.l     a0,12(a7)
		move.w     d0,10(a7)
		move.w     d1,8(a7)
		move.w     d2,6(a7)
		move.w     10(a7),d0
		bne.s      Adr_find_1
		move.w     20(a7),-(a7)
		move.w     8(a7),d2
		move.w     10(a7),d1
		clr.w      d0
		movea.l    14(a7),a0
		bsr        Adr_find0
		addq.w     #2,a7
		bra.s      Adr_find_2
		bra.s      Adr_find_2
Adr_find_1:
		move.w     10(a7),d0
		movea.l    12(a7),a0
		jsr        Aob_up
		move.w     d0,(a7)
		move.l     _globl,-(a7)
		pea.l      6(a7)
		lea.l      12(a7),a1
		move.w     8(a7),d0
		movea.l    20(a7),a0
		jsr        mt_objc_offset
		addq.w     #8,a7
		move.w     20(a7),d0
		sub.w      2(a7),d0
		move.w     d0,-(a7)
		move.w     8(a7),d2
		sub.w      6(a7),d2
		move.w     10(a7),d1
		move.w     12(a7),d0
		movea.l    14(a7),a0
		bsr        Adr_find0
		addq.w     #2,a7
		nop
Adr_find_2:
		lea.l      16(a7),a7
		rts

addDD2Popup:
		lea.l      -12(a7),a7
		move.l     a0,8(a7)
		move.l     a1,4(a7)
		moveq.l    #2,d0
		movea.l    4(a7),a0
		and.l      2(a0),d0
		beq.s      addDD2Popup_1
		movea.l    4(a7),a0
		movea.l    8(a0),a0
		jsr        strlen
		move.l     d0,(a7)
		move.l     (a7),d0
		ble.s      addDD2Popup_1
		movea.l    8(a7),a0
		movea.l    (a0),a0
		jsr        strlen
		add.l      (a7),d0
		cmp.l      #$00000100,d0
		bcc.s      addDD2Popup_1
		movea.l    4(a7),a0
		movea.l    8(a0),a1
		movea.l    8(a7),a0
		movea.l    (a0),a0
		jsr        strcat
		lea.l      xe071a,a1
		movea.l    8(a7),a0
		movea.l    (a0),a0
		jsr        strcat
		movea.l    8(a7),a0
		move.l     4(a0),d0
		cmp.l      (a7),d0
		bge.s      addDD2Popup_1
		movea.l    8(a7),a0
		move.l     (a7),4(a0)
addDD2Popup_1:
		lea.l      12(a7),a7
		rts

DDCmpName:
		subq.w     #8,a7
		move.l     a0,4(a7)
		move.l     a1,(a7)
		movea.l    (a7),a0
		movea.l    8(a0),a0
		jsr        strlen
		move.l     d0,-(a7)
		movea.l    8(a7),a0
		jsr        strlen
		cmp.l      (a7)+,d0
		bcc.s      DDCmpName_1
		movea.l    4(a7),a0
		jsr        strlen
		bra.s      DDCmpName_2
DDCmpName_1:
		movea.l    (a7),a0
		movea.l    8(a0),a0
		jsr        strlen
DDCmpName_2:
		movea.l    (a7),a0
		movea.l    8(a0),a1
		movea.l    4(a7),a0
		jsr        strncmp
		tst.w      d0
		bne.s      DDCmpName_3
		moveq.l    #1,d0
		bra.s      DDCmpName_4
DDCmpName_3:
		clr.w      d0
DDCmpName_4:
		addq.w     #8,a7
		rts

	.globl Adr_drag
Adr_drag:
		move.w     d3,-(a7)
		move.l     a2,-(a7)
		lea.l      -546(a7),a7
		move.w     d0,388(a7)
		move.w     d1,386(a7)
		lea.l      xe05f6,a0
		lea.l      126(a7),a1
		move.w     #$00FF,d0
Adr_drag_1:
		move.b     (a0)+,(a1)+
		dbf        d0,Adr_drag_1
		clr.l      50(a7)
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		bgt.s      Adr_drag_2
		bra        Adr_drag_3
Adr_drag_2:
		movea.l    ACSblk,a0
		move.l     576(a0),46(a7)
		move.w     #$0001,(a7)
		move.w     #$0001,2(a7)
		movea.l    ACSblk,a0
		move.w     8(a0),4(a7)
		movea.l    ACSblk,a0
		move.w     8(a0),d0
		movea.l    ACSblk,a0
		add.w      12(a0),d0
		subq.w     #1,d0
		move.w     d0,6(a7)
		movea.l    ACSblk,a0
		move.w     10(a0),8(a7)
		movea.l    ACSblk,a0
		move.w     10(a0),d0
		movea.l    ACSblk,a0
		add.w      12(a0),d0
		subq.w     #1,d0
		move.w     d0,10(a7)
		moveq.l    #3,d0
		move.w     d0,12(a7)
		move.w     d0,14(a7)
		move.w     d0,16(a7)
		move.w     d0,18(a7)
		move.w     d0,20(a7)
		move.w     d0,22(a7)
		move.w     d0,24(a7)
		move.w     d0,26(a7)
		lea.l      (a7),a1
		moveq.l    #18,d0
		movea.l    46(a7),a0
		movea.l    46(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
		bsr        drag_set
		clr.l      42(a7)
		move.w     388(a7),d0
		ext.l      d0
		divs.w     (a7),d0
		swap       d0
		move.w     d0,32(a7)
		move.w     386(a7),d0
		ext.l      d0
		divs.w     2(a7),d0
		swap       d0
		move.w     d0,30(a7)
		move.w     388(a7),92(a7)
		move.w     386(a7),90(a7)
		movea.l    ACSblk,a0
		move.w     614(a0),74(a7)
		moveq.l    #3,d0
		and.w      74(a7),d0
		beq.s      Adr_drag_4
		ori.w      #$0003,74(a7)
Adr_drag_4:
		asr.w      74(a7)
		move.w     74(a7),d0
		add.w      d0,d0
		move.w     12(a7,d0.w),28(a7)
		move.w     28(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		lea.l      56(a0,d0.l),a0
		jsr        Amo_new
		move.w     #$FFFF,70(a7)
Adr_drag_39:
		move.w     92(a7),d0
		sub.w      388(a7),d0
		move.w     d0,84(a7)
		move.w     90(a7),d0
		sub.w      386(a7),d0
		move.w     d0,82(a7)
		move.w     82(a7),d1
		move.w     84(a7),d0
		bsr        drag_draw
Adr_drag_12:
		move.w     92(a7),88(a7)
		move.w     90(a7),86(a7)
		move.l     _globl,-(a7)
		pea.l      84(a7)
		pea.l      70(a7)
		lea.l      102(a7),a1
		lea.l      104(a7),a0
		jsr        mt_graf_mkstate
		lea.l      12(a7),a7
		move.w     80(a7),74(a7)
		moveq.l    #3,d0
		and.w      74(a7),d0
		beq.s      Adr_drag_5
		ori.w      #$0003,74(a7)
Adr_drag_5:
		asr.w      74(a7)
		move.w     74(a7),d0
		add.w      d0,d0
		move.w     28(a7),d1
		cmp.w      12(a7,d0.w),d1
		beq.s      Adr_drag_6
		move.w     74(a7),d0
		add.w      d0,d0
		move.w     12(a7,d0.w),28(a7)
		move.w     28(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		add.l      d0,d0
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		lea.l      56(a0,d0.l),a0
		jsr        Amo_new
Adr_drag_6:
		move.w     (a7),d0
		asr.w      #1,d0
		add.w      d0,92(a7)
		move.w     2(a7),d0
		asr.w      #1,d0
		add.w      d0,90(a7)
		move.w     92(a7),d0
		cmp.w      4(a7),d0
		bge.s      Adr_drag_7
		move.w     4(a7),92(a7)
Adr_drag_7:
		move.w     92(a7),d0
		cmp.w      6(a7),d0
		ble.s      Adr_drag_8
		move.w     6(a7),92(a7)
Adr_drag_8:
		move.w     90(a7),d0
		cmp.w      8(a7),d0
		bge.s      Adr_drag_9
		move.w     8(a7),90(a7)
Adr_drag_9:
		move.w     90(a7),d0
		cmp.w      10(a7),d0
		ble.s      Adr_drag_10
		move.w     10(a7),90(a7)
Adr_drag_10:
		move.w     92(a7),d0
		sub.w      32(a7),d0
		ext.l      d0
		divs.w     (a7),d0
		swap       d0
		sub.w      d0,92(a7)
		move.w     90(a7),d0
		sub.w      30(a7),d0
		ext.l      d0
		divs.w     2(a7),d0
		swap       d0
		sub.w      d0,90(a7)
		move.w     62(a7),d0
		beq.s      Adr_drag_11
		move.w     88(a7),d0
		cmp.w      92(a7),d0
		bne.s      Adr_drag_11
		move.w     86(a7),d0
		cmp.w      90(a7),d0
		beq        Adr_drag_12
Adr_drag_11:
		move.w     82(a7),d1
		move.w     84(a7),d0
		bsr        drag_draw
		movea.l    _globl,a0
		move.w     90(a7),d1
		move.w     92(a7),d0
		jsr        mt_wind_find
		move.w     d0,68(a7)
		move.w     68(a7),d0
		jsr        Awi_wid
		move.l     a0,46(a7)
		move.l     46(a7),d0
		bne.s      Adr_drag_13
		moveq.l    #1,d0
		bra.s      Adr_drag_14
Adr_drag_13:
		clr.w      d0
Adr_drag_14:
		move.w     d0,66(a7)
		move.l     46(a7),d0
		beq        Adr_drag_15
		movea.l    46(a7),a0
		move.l     20(a0),d0
		bne.s      Adr_drag_16
		movea.l    46(a7),a0
		move.l     24(a0),d0
		beq        Adr_drag_15
Adr_drag_16:
		move.w     90(a7),d0
		movea.l    46(a7),a0
		sub.w      54(a0),d0
		move.w     d0,-(a7)
		move.w     94(a7),d2
		movea.l    48(a7),a0
		sub.w      52(a0),d2
		moveq.l    #8,d1
		clr.w      d0
		movea.l    48(a7),a0
		movea.l    20(a0),a0
		bsr        Adr_find
		addq.w     #2,a7
		move.w     d0,72(a7)
		move.w     72(a7),d0
		bpl.s      Adr_drag_17
		movea.l    46(a7),a0
		move.l     24(a0),d0
		beq.s      Adr_drag_17
		move.w     90(a7),d0
		movea.l    46(a7),a0
		sub.w      54(a0),d0
		move.w     d0,-(a7)
		move.w     94(a7),d2
		movea.l    48(a7),a0
		sub.w      52(a0),d2
		moveq.l    #8,d1
		clr.w      d0
		movea.l    48(a7),a0
		movea.l    24(a0),a0
		bsr        Adr_find
		addq.w     #2,a7
		move.w     d0,72(a7)
		move.w     72(a7),d0
		bmi.s      Adr_drag_17
		ori.w      #$1000,72(a7)
Adr_drag_17:
		bra        Adr_drag_18
Adr_drag_27:
		movea.l    46(a7),a0
		cmpa.l     42(a7),a0
		bne.s      Adr_drag_19
		move.w     72(a7),d0
		cmp.w      70(a7),d0
		bne.s      Adr_drag_19
		bra        Adr_drag_20
Adr_drag_19:
		move.w     72(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_drag_21
		move.w     72(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    46(a7),a0
		movea.l    24(a0),a0
		adda.l     d0,a0
		move.l     a0,38(a7)
		bra.s      Adr_drag_22
Adr_drag_21:
		move.w     72(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    46(a7),a0
		movea.l    20(a0),a0
		adda.l     d0,a0
		move.l     a0,38(a7)
Adr_drag_22:
		movea.l    38(a7),a0
		move.w     8(a0),d0
		and.w      #$1000,d0
		bne.s      Adr_drag_23
		movea.l    38(a7),a0
		cmpi.b     #$18,7(a0)
		bne.s      Adr_drag_24
		moveq.l    #8,d0
		movea.l    38(a7),a0
		and.w      8(a0),d0
		beq.s      Adr_drag_24
Adr_drag_23:
		bra.s      Adr_drag_20
Adr_drag_24:
		movea.l    38(a7),a0
		move.w     8(a0),d0
		and.w      #$2000,d0
		beq.s      Adr_drag_25
		moveq.l    #1,d0
		movea.l    38(a7),a0
		and.w      10(a0),d0
		beq.s      Adr_drag_25
		move.w     #$FFFF,72(a7)
		bra.s      Adr_drag_20
Adr_drag_25:
		move.w     72(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_drag_26
		move.w     72(a7),d0
		and.w      #$0FFF,d0
		movea.l    46(a7),a0
		movea.l    24(a0),a0
		jsr        Aob_up
		or.w       #$1000,d0
		move.w     d0,72(a7)
		bra.s      Adr_drag_18
Adr_drag_26:
		move.w     72(a7),d0
		movea.l    46(a7),a0
		movea.l    20(a0),a0
		jsr        Aob_up
		move.w     d0,72(a7)
Adr_drag_18:
		move.w     72(a7),d0
		bpl        Adr_drag_27
Adr_drag_20:
		bra.s      Adr_drag_28
Adr_drag_15:
		move.w     #$FFFF,72(a7)
Adr_drag_28:
		move.w     72(a7),d0
		cmp.w      70(a7),d0
		bne.s      Adr_drag_29
		movea.l    46(a7),a0
		cmpa.l     42(a7),a0
		beq        Adr_drag_30
Adr_drag_29:
		move.w     70(a7),d0
		bmi.s      Adr_drag_31
		move.w     70(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_drag_32
		move.w     70(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		movea.l    24(a0),a0
		adda.l     d0,a0
		move.l     a0,38(a7)
		bra.s      Adr_drag_33
Adr_drag_32:
		move.w     70(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    42(a7),a0
		movea.l    20(a0),a0
		adda.l     d0,a0
		move.l     a0,38(a7)
Adr_drag_33:
		movea.l    38(a7),a0
		move.w     8(a0),d0
		and.w      #$0800,d0
		bne.s      Adr_drag_31
		movea.l    38(a7),a0
		move.w     10(a0),d1
		and.w      #$FFFE,d1
		move.w     70(a7),d0
		movea.l    42(a7),a0
		movea.l    42(a7),a1
		movea.l    102(a1),a1
		jsr        (a1)
Adr_drag_31:
		move.w     #$FFFF,70(a7)
		move.w     72(a7),d0
		bmi        Adr_drag_30
		move.w     72(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_drag_34
		move.w     72(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    46(a7),a0
		movea.l    24(a0),a0
		adda.l     d0,a0
		move.l     a0,38(a7)
		bra.s      Adr_drag_35
Adr_drag_34:
		move.w     72(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    46(a7),a0
		movea.l    20(a0),a0
		adda.l     d0,a0
		move.l     a0,38(a7)
Adr_drag_35:
		movea.l    38(a7),a0
		move.w     8(a0),d0
		and.w      #$2000,d0
		beq.s      Adr_drag_36
		moveq.l    #1,d0
		movea.l    38(a7),a0
		and.w      10(a0),d0
		beq.s      Adr_drag_36
		move.w     #$FFFF,72(a7)
		bra.s      Adr_drag_37
Adr_drag_36:
		movea.l    38(a7),a0
		move.w     8(a0),d0
		and.w      #$0800,d0
		bne.s      Adr_drag_37
		move.w     72(a7),58(a7)
		move.w     #$0001,60(a7)
		lea.l      58(a7),a1
		moveq.l    #9,d0
		movea.l    46(a7),a0
		movea.l    46(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
		cmpi.w     #$0001,60(a7)
		bne.s      Adr_drag_38
		moveq.l    #1,d1
		movea.l    38(a7),a0
		or.w       10(a0),d1
		move.w     72(a7),d0
		movea.l    46(a7),a0
		movea.l    46(a7),a1
		movea.l    102(a1),a1
		jsr        (a1)
		bra.s      Adr_drag_37
Adr_drag_38:
		move.w     #$FFFF,72(a7)
Adr_drag_37:
		move.l     46(a7),42(a7)
		move.w     72(a7),70(a7)
Adr_drag_30:
		move.w     62(a7),d0
		bne        Adr_drag_39
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		lea.l      56(a0),a0
		jsr        Amo_new
		movea.l    ACSblk,a0
		move.w     #$0001,586(a0)
		move.w     70(a7),d0
		bmi        Adr_drag_40
		move.w     70(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_drag_41
		movea.l    42(a7),a0
		move.l     24(a0),34(a7)
		bra.s      Adr_drag_42
Adr_drag_41:
		movea.l    42(a7),a0
		move.l     20(a0),34(a7)
Adr_drag_42:
		move.w     70(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    34(a7),a0
		lea.l      24(a0,d0.l),a0
		move.l     a0,118(a7)
		movea.l    118(a7),a0
		move.w     8(a0),d0
		and.w      #$8000,d0
		beq        Adr_drag_43
		movea.l    118(a7),a0
		move.l     4(a0),d0
		beq        Adr_drag_43
		movea.l    ACSblk,a0
		move.w     388(a7),588(a0)
		movea.l    ACSblk,a0
		move.w     386(a7),590(a0)
		movea.l    ACSblk,a0
		move.w     84(a7),592(a0)
		movea.l    ACSblk,a0
		move.w     82(a7),594(a0)
		lea.l      94(a7),a0
		jsr        Act_save
		movea.l    ACSblk,a0
		move.w     92(a7),610(a0)
		movea.l    ACSblk,a0
		move.w     90(a7),612(a0)
		movea.l    ACSblk,a0
		move.w     80(a7),614(a0)
		movea.l    ACSblk,a0
		move.l     42(a7),600(a0)
		movea.l    ACSblk,a0
		move.l     34(a7),604(a0)
		move.w     70(a7),d0
		and.w      #$0FFF,d0
		movea.l    ACSblk,a0
		move.w     d0,608(a0)
		jsr        Amo_busy
		movea.l    118(a7),a0
		movea.l    4(a0),a0
		jsr        (a0)
		jsr        Amo_unbusy
		lea.l      94(a7),a0
		jsr        Act_restore
		bra        Adr_drag_44
Adr_drag_43:
		move.w     70(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    34(a7),a0
		move.l     12(a0,d0.l),50(a7)
		movea.l    50(a7),a0
		move.l     8(a0),d0
		beq        Adr_drag_45
		bsr        Adr_start
		bsr        Adr_next
		move.w     d0,72(a7)
		ble        Adr_drag_46
		move.w     72(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_drag_47
		move.w     72(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		movea.l    24(a0),a0
		lea.l      24(a0,d0.l),a0
		move.l     a0,118(a7)
		bra.s      Adr_drag_48
Adr_drag_47:
		move.w     72(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		movea.l    20(a0),a0
		lea.l      24(a0,d0.l),a0
		move.l     a0,118(a7)
Adr_drag_48:
		movea.l    118(a7),a0
		move.w     22(a0),d0
		sub.w      #$000B,d0
		beq.s      Adr_drag_49
		sub.w      #$0009,d0
		beq.s      Adr_drag_49
		sub.w      #$000B,d0
		beq.s      Adr_drag_49
		bra.s      Adr_drag_50
Adr_drag_49:
		movea.l    118(a7),a0
		move.l     12(a0),d0
		beq.s      Adr_drag_51
		movea.l    118(a7),a0
		movea.l    12(a0),a1
		move.w     #$02C1,d0
		move.w     70(a7),d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    34(a7),a0
		adda.l     d1,a0
		movea.l    50(a7),a2
		movea.l    8(a2),a2
		jsr        (a2)
		tst.w      d0
		bne.s      Adr_drag_52
Adr_drag_51:
		clr.l      50(a7)
Adr_drag_52:
		bra.s      Adr_drag_53
Adr_drag_50:
		clr.l      50(a7)
Adr_drag_53:
		bra.s      Adr_drag_54
Adr_drag_46:
		clr.l      50(a7)
Adr_drag_54:
		bra.s      Adr_drag_44
Adr_drag_45:
		clr.l      50(a7)
Adr_drag_44:
		movea.l    42(a7),a0
		movea.l    34(a7),a1
		cmpa.l     20(a0),a1
		beq.s      Adr_drag_55
		movea.l    42(a7),a0
		movea.l    34(a7),a1
		cmpa.l     24(a0),a1
		bne.s      Adr_drag_56
Adr_drag_55:
		move.w     70(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    34(a7),a0
		move.w     8(a0,d0.l),d0
		and.w      #$0800,d0
		bne.s      Adr_drag_56
		move.w     70(a7),d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d0
		add.l      d0,d0
		add.l      d2,d0
		lsl.l      #3,d0
		movea.l    34(a7),a0
		move.w     10(a0,d0.l),d1
		and.w      #$FFFE,d1
		move.w     70(a7),d0
		movea.l    42(a7),a0
		movea.l    42(a7),a1
		movea.l    102(a1),a1
		jsr        (a1)
Adr_drag_56:
		move.l     50(a7),d0
		beq.s      Adr_drag_57
		suba.l     a1,a1
		moveq.l    #5,d0
		move.w     70(a7),d2
		and.w      #$0FFF,d2
		ext.l      d2
		move.l     d2,d1
		add.l      d1,d1
		add.l      d2,d1
		lsl.l      #3,d1
		movea.l    34(a7),a0
		adda.l     d1,a0
		movea.l    50(a7),a2
		movea.l    8(a2),a2
		jsr        (a2)
Adr_drag_57:
		jsr        Aev_release
		bra        Adr_drag_58
Adr_drag_40:
		move.w     66(a7),d0
		beq        Adr_drag_58
		move.w     #$FFFF,64(a7)
		move.l     _globl,-(a7)
		clr.l      -(a7)
		clr.l      -(a7)
		suba.l     a1,a1
		lea.l      88(a7),a0
		moveq.l    #11,d0
		jsr        mt_appl_getinfo
		lea.l      12(a7),a7
		tst.w      d0
		beq.s      Adr_drag_59
		moveq.l    #16,d0
		and.w      76(a7),d0
		beq.s      Adr_drag_59
		clr.l      -(a7)
		clr.l      -(a7)
		clr.l      -(a7)
		pea.l      76(a7)
		moveq.l    #20,d1
		move.w     84(a7),d0
		jsr        wind_get
		lea.l      16(a7),a7
		tst.w      d0
		bne.s      Adr_drag_59
		move.w     #$FFFF,64(a7)
Adr_drag_59:
		move.w     64(a7),d0
		bpl        Adr_drag_60
		clr.w      78(a7)
		clr.w      76(a7)
		clr.b      126(a7)
		lea.l      126(a7),a0
		move.l     a0,390(a7)
		clr.l      394(a7)
		pea.l      addDD2Popup(pc)
		clr.l      -(a7)
		lea.l      398(a7),a1
		movea.l    ListOfApps,a0
		movea.l    ListOfApps,a2
		movea.l    64(a2),a2
		jsr        (a2)
		addq.w     #8,a7
		move.w     396(a7),76(a7)
		lea.l      126(a7),a0
		jsr        Ast_isEmpty
		tst.w      d0
		bne.s      Adr_drag_60
		lea.l      126(a7),a0
		jsr        strlen
		clr.b      125(a7,d0.w)
		lea.l      126(a7),a0
		move.l     a0,122(a7)
		move.l     122(a7),-(a7)
		moveq.l    #-1,d2
		moveq.l    #-1,d1
		moveq.l    #3,d0
		add.w      80(a7),d0
		movea.l    ACSblk,a0
		muls.w     18(a0),d0
		lea.l      130(a7),a1
		movea.l    ACSblk,a0
		movea.l    600(a0),a0
		jsr        Ame_strpopup
		addq.w     #4,a7
		move.l     a0,122(a7)
		move.l     122(a7),d0
		beq.s      Adr_drag_60
		pea.l      DDCmpName(pc)
		movea.l    126(a7),a1
		movea.l    ListOfApps,a0
		movea.l    ListOfApps,a2
		movea.l    32(a2),a2
		jsr        (a2)
		addq.w     #4,a7
		move.l     a0,382(a7)
		movea.l    382(a7),a0
		move.w     (a0),64(a7)
Adr_drag_60:
		move.w     64(a7),d0
		bmi        Adr_drag_61
		lea.l      xe06f6,a0
		lea.l      530(a7),a1
		moveq.l    #15,d0
Adr_drag_62:
		move.b     (a0)+,(a1)+
		dbf        d0,Adr_drag_62
		clr.l      522(a7)
		lea.l      xe0706,a0
		lea.l      500(a7),a1
		moveq.l    #19,d0
Adr_drag_63:
		move.b     (a0)+,(a1)+
		dbf        d0,Adr_drag_63
		clr.l      446(a7)
		clr.l      442(a7)
		jsr        Dgetdrv
		jsr        Dsetdrv
		and.l      #$00100000,d0
		beq        Adr_drag_64
		lea.l      390(a7),a1
		lea.l      xe071c,a0
		clr.w      d0
		jsr        Fxattr
		tst.l      d0
		bne        Adr_drag_64
Adr_drag_68:
		addq.b     #1,518(a7)
		cmpi.b     #$5A,518(a7)
		ble.s      Adr_drag_65
		addq.b     #1,517(a7)
		cmpi.b     #$5A,517(a7)
		ble.s      Adr_drag_66
		bra.s      Adr_drag_67
		bra.s      Adr_drag_65
Adr_drag_66:
		move.b     #$41,518(a7)
Adr_drag_65:
		moveq.l    #2,d0
		lea.l      500(a7),a0
		jsr        Fcreate
		move.l     d0,458(a7)
		move.l     458(a7),d0
		bmi.s      Adr_drag_68
Adr_drag_67:
		move.l     458(a7),d0
		bmi        Adr_drag_69
		clr.w      d0
		jsr        Awi_update
		move.w     #$003F,530(a7)
		movea.l    ACSblk,a0
		move.w     (a0),532(a7)
		move.w     68(a7),536(a7)
		move.w     92(a7),538(a7)
		move.w     90(a7),540(a7)
		move.w     80(a7),542(a7)
		move.b     517(a7),d0
		ext.w      d0
		lsl.w      #8,d0
		move.b     518(a7),d1
		ext.w      d1
		or.w       d1,d0
		move.w     d0,544(a7)
		movea.l    _globl,a1
		lea.l      530(a7),a0
		moveq.l    #16,d1
		move.w     64(a7),d0
		jsr        mt_appl_write
		tst.w      d0
		beq        Adr_drag_70
		moveq.l    #1,d0
		move.b     461(a7),d1
		lsl.l      d1,d0
		move.l     d0,454(a7)
		clr.l      -(a7)
		suba.l     a1,a1
		lea.l      458(a7),a0
		move.w     #$0BB8,d0
		jsr        Fselect
		addq.w     #4,a7
		tst.w      d0
		beq        Adr_drag_70
		move.l     454(a7),d0
		beq        Adr_drag_70
		lea.l      520(a7),a0
		moveq.l    #1,d1
		move.w     460(a7),d0
		jsr        Fread
		moveq.l    #1,d1
		cmp.l      d0,d1
		bne        Adr_drag_70
		move.b     520(a7),d0
		bne        Adr_drag_70
		lea.l      466(a7),a0
		moveq.l    #32,d1
		move.w     460(a7),d0
		jsr        Fread
		moveq.l    #32,d1
		cmp.l      d0,d1
		bne        Adr_drag_70
		/* movea.l    #$00000001,a0 */
		dc.w 0x207c,0,1
		moveq.l    #13,d0
		jsr        Psignal
		move.l     d0,450(a7)
		bsr        Adr_start
		bsr        Adr_next
		move.w     d0,72(a7)
		ble        Adr_drag_71
		move.w     72(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_drag_72
		move.w     72(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		movea.l    24(a0),a0
		lea.l      24(a0,d0.l),a0
		move.l     a0,118(a7)
		bra.s      Adr_drag_73
Adr_drag_72:
		move.w     72(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		movea.l    20(a0),a0
		lea.l      24(a0,d0.l),a0
		move.l     a0,118(a7)
Adr_drag_73:
		movea.l    118(a7),a0
		move.w     22(a0),d0
		sub.w      #$000B,d0
		beq.s      Adr_drag_74
		sub.w      #$0009,d0
		beq.s      Adr_drag_75
		sub.w      #$000B,d0
		beq.s      Adr_drag_74
		bra.s      Adr_drag_76
Adr_drag_74:
		lea.l      xe0724,a1
		lea.l      466(a7),a0
		jsr        strcpy
		bra.s      Adr_drag_77
Adr_drag_75:
		lea.l      xe072f,a1
		lea.l      466(a7),a0
		jsr        strcpy
		bra.s      Adr_drag_77
Adr_drag_76:
		movea.l    450(a7),a0
		moveq.l    #13,d0
		jsr        Psignal
		move.w     460(a7),d0
		jsr        Fclose
		moveq.l    #1,d0
		jsr        Awi_update
		bra        Adr_drag_64
Adr_drag_77:
		move.w     #$000A,526(a7)
		movea.l    118(a7),a0
		movea.l    12(a0),a0
		jsr        strlen
		move.l     d0,462(a7)
		move.l     462(a7),d0
		moveq.l    #24,d1
		asr.l      d1,d0
		/* and.b      #$FF,d0 */
		dc.w 0xc03c,0xffff
		move.b     d0,470(a7)
		move.l     462(a7),d0
		moveq.l    #16,d1
		asr.l      d1,d0
		/* and.b      #$FF,d0 */
		dc.w 0xc03c,0xffff
		move.b     d0,471(a7)
		move.l     462(a7),d0
		asr.l      #8,d0
		/* and.b      #$FF,d0 */
		dc.w 0xc03c,0xffff
		move.b     d0,472(a7)
		moveq.l    #-1,d0
		and.b      465(a7),d0
		move.b     d0,473(a7)
		lea.l      526(a7),a0
		moveq.l    #2,d1
		move.w     460(a7),d0
		jsr        Fwrite
		moveq.l    #2,d1
		cmp.l      d0,d1
		bne        Adr_drag_71
		lea.l      466(a7),a0
		moveq.l    #10,d1
		move.w     460(a7),d0
		jsr        Fwrite
		moveq.l    #10,d1
		cmp.l      d0,d1
		bne.w      Adr_drag_71
		movea.l    _globl,a0
		moveq.l    #10,d0
		jsr        mt_evnt_timer
		tst.w      d0
		beq.s      Adr_drag_71
		lea.l      520(a7),a0
		moveq.l    #1,d1
		move.w     460(a7),d0
		jsr        Fread
		moveq.l    #1,d1
		cmp.l      d0,d1
		bne.s      Adr_drag_71
		move.b     520(a7),d0
		bne.s      Adr_drag_71
		movea.l    118(a7),a0
		movea.l    12(a0),a0
		move.l     a0,-(a7)
		movea.l    122(a7),a0
		movea.l    12(a0),a0
		jsr        strlen
		move.l     d0,d1
		move.w     464(a7),d0
		movea.l    (a7)+,a0
		jsr        Fwrite
		move.l     462(a7),d1
		cmp.l      d0,d1
		beq.s      Adr_drag_71
		movea.l    450(a7),a0
		moveq.l    #13,d0
		jsr        Psignal
		move.w     460(a7),d0
		jsr        Fclose
		moveq.l    #1,d0
		jsr        Awi_update
		bra.s      Adr_drag_64
Adr_drag_71:
		movea.l    450(a7),a0
		moveq.l    #13,d0
		jsr        Psignal
Adr_drag_70:
		moveq.l    #1,d0
		jsr        Awi_update
		move.w     460(a7),d0
		jsr        Fclose
Adr_drag_69:
		bra        Adr_drag_78
Adr_drag_64:
		bsr        Adr_start
		bsr        Adr_next
		move.w     d0,72(a7)
		ble        Adr_drag_78
		move.w     72(a7),d0
		and.w      #$1000,d0
		beq.s      Adr_drag_79
		move.w     72(a7),d1
		and.w      #$0FFF,d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		movea.l    24(a0),a0
		lea.l      24(a0,d0.l),a0
		move.l     a0,118(a7)
		bra.s      Adr_drag_80
Adr_drag_79:
		move.w     72(a7),d1
		ext.l      d1
		move.l     d1,d0
		add.l      d0,d0
		add.l      d1,d0
		lsl.l      #3,d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		movea.l    20(a0),a0
		lea.l      24(a0,d0.l),a0
		move.l     a0,118(a7)
Adr_drag_80:
		movea.l    118(a7),a0
		move.w     22(a0),d0
		sub.w      #$000A,d0
		beq        Adr_drag_81
		subq.w     #1,d0
		beq.s      Adr_drag_82
		sub.w      #$0009,d0
		beq.s      Adr_drag_82
		sub.w      #$000B,d0
		beq.s      Adr_drag_82
		bra        Adr_drag_83
Adr_drag_82:
		movea.l    118(a7),a0
		movea.l    12(a0),a0
		jsr        strlen
		addq.l     #1,d0
		jsr        Ax_glmalloc
		move.l     a0,522(a7)
		move.l     522(a7),d0
		beq        Adr_drag_84
		movea.l    118(a7),a0
		movea.l    12(a0),a1
		movea.l    522(a7),a0
		jsr        strcpy
		moveq.l    #16,d1
		clr.w      d0
		lea.l      530(a7),a0
		jsr        memset
		move.w     #$0501,530(a7)
		move.l     522(a7),d0
		moveq.l    #16,d1
		asr.l      d1,d0
		move.w     d0,538(a7)
		move.w     524(a7),540(a7)
		clr.w      d0
		jsr        Awi_update
		jsr        Aev_mess
		movea.l    _globl,a1
		lea.l      530(a7),a0
		moveq.l    #16,d1
		move.w     64(a7),d0
		jsr        mt_appl_write
		moveq.l    #16,d1
		clr.w      d0
		lea.l      530(a7),a0
		jsr        memset
		move.l     _globl,-(a7)
		pea.l      530(a7)
		pea.l      534(a7)
		pea.l      538(a7)
		pea.l      542(a7)
		pea.l      546(a7)
		pea.l      ($000007D0).w
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		lea.l      576(a7),a1
		lea.l      580(a7),a0
		clr.w      d2
		clr.w      d1
		moveq.l    #48,d0
		jsr        mt_evnt_multi
		lea.l      50(a7),a7
		move.w     d0,528(a7)
		moveq.l    #16,d0
		and.w      528(a7),d0
		beq.s      Adr_drag_85
		cmpi.w     #$0500,530(a7)
		beq.s      Adr_drag_86
		movea.l    _globl,a1
		lea.l      530(a7),a0
		moveq.l    #16,d1
		movea.l    ACSblk,a2
		move.w     (a2),d0
		jsr        mt_appl_write
		bra.s      Adr_drag_85
Adr_drag_86:
		move.w     536(a7),d0
		beq.s      Adr_drag_85
		move.w     72(a7),d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		bsr        Adr_del
Adr_drag_85:
		moveq.l    #1,d0
		jsr        Awi_update
		movea.l    522(a7),a0
		jsr        Ax_glfree
Adr_drag_84:
		bra        Adr_drag_83
Adr_drag_81:
		pea.l      462(a7)
		lea.l      450(a7),a1
		movea.l    122(a7),a0
		movea.l    12(a0),a0
		jsr        Abp_mfdb2img
		addq.w     #4,a7
		tst.w      d0
		bne        Adr_drag_87
		movea.l    446(a7),a0
		move.w     2(a0),d0
		add.w      d0,d0
		ext.l      d0
		add.l      d0,462(a7)
		move.l     462(a7),d0
		jsr        Ax_glmalloc
		move.l     a0,442(a7)
		beq        Adr_drag_88
		move.l     462(a7),d0
		movea.l    446(a7),a1
		movea.l    442(a7),a0
		jsr        memcpy
		moveq.l    #16,d1
		clr.w      d0
		lea.l      530(a7),a0
		jsr        memset
		move.w     #$0504,530(a7)
		move.w     #$0001,536(a7)
		move.l     442(a7),d0
		moveq.l    #16,d1
		asr.l      d1,d0
		move.w     d0,538(a7)
		move.w     444(a7),540(a7)
		move.l     462(a7),d0
		moveq.l    #16,d1
		asr.l      d1,d0
		move.w     d0,542(a7)
		move.w     464(a7),544(a7)
		clr.w      d0
		jsr        Awi_update
		jsr        Aev_mess
		movea.l    _globl,a1
		lea.l      530(a7),a0
		moveq.l    #16,d1
		move.w     64(a7),d0
		jsr        mt_appl_write
		moveq.l    #16,d1
		clr.w      d0
		lea.l      530(a7),a0
		jsr        memset
		move.l     _globl,-(a7)
		pea.l      530(a7)
		pea.l      534(a7)
		pea.l      538(a7)
		pea.l      542(a7)
		pea.l      546(a7)
		pea.l      ($00000BB8).w
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		clr.w      -(a7)
		lea.l      576(a7),a1
		lea.l      580(a7),a0
		clr.w      d2
		clr.w      d1
		moveq.l    #48,d0
		jsr        mt_evnt_multi
		lea.l      50(a7),a7
		move.w     d0,528(a7)
		moveq.l    #16,d0
		and.w      528(a7),d0
		beq.s      Adr_drag_89
		cmpi.w     #$0500,530(a7)
		beq.s      Adr_drag_90
		movea.l    _globl,a1
		lea.l      530(a7),a0
		moveq.l    #16,d1
		movea.l    ACSblk,a2
		move.w     (a2),d0
		jsr        mt_appl_write
		bra.s      Adr_drag_89
Adr_drag_90:
		move.w     536(a7),d0
		beq.s      Adr_drag_89
		move.w     72(a7),d0
		movea.l    ACSblk,a0
		movea.l    576(a0),a0
		bsr        Adr_del
Adr_drag_89:
		moveq.l    #1,d0
		jsr        Awi_update
		movea.l    442(a7),a0
		jsr        Ax_glfree
Adr_drag_88:
		movea.l    446(a7),a0
		jsr        Ax_free
Adr_drag_87:
		nop
Adr_drag_83:
		movea.l    ACSblk,a0
		clr.w      586(a0)
Adr_drag_78:
		bra.s      Adr_drag_58
Adr_drag_61:
		movea.l    ACSblk,a0
		move.l     576(a0),46(a7)
		lea.l      68(a7),a1
		moveq.l    #19,d0
		movea.l    46(a7),a0
		movea.l    46(a7),a2
		movea.l    4(a2),a2
		jsr        (a2)
Adr_drag_58:
		movea.l    ACSblk,a0
		move.w     586(a0),d0
		bne.s      Adr_drag_91
		bra        Adr_drag_3
Adr_drag_91:
		movea.l    ACSblk,a0
		move.w     582(a0),d0
		bne.s      Adr_drag_92
		bra        Adr_drag_3
Adr_drag_92:
		moveq.l    #2,d0
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		and.w      14(a0),d0
		beq        Adr_drag_3
		move.w     84(a7),d0
		ble.s      Adr_drag_93
		move.w     84(a7),d0
		bra.s      Adr_drag_94
Adr_drag_93:
		move.w     84(a7),d0
		neg.w      d0
Adr_drag_94:
		move.w     d0,-(a7)
		move.w     84(a7),d0
		ble.s      Adr_drag_95
		move.w     84(a7),d0
		bra.s      Adr_drag_96
Adr_drag_95:
		move.w     84(a7),d0
		neg.w      d0
Adr_drag_96:
		add.w      (a7)+,d0
		asr.w      #5,d0
		move.w     d0,56(a7)
		clr.w      54(a7)
		bra.s      Adr_drag_97
Adr_drag_98:
		move.w     56(a7),d0
		asr.w      #1,d0
		add.w      56(a7),d0
		asr.w      #2,d0
		move.w     d0,56(a7)
		addq.w     #1,54(a7)
Adr_drag_97:
		move.w     56(a7),d0
		bne.s      Adr_drag_98
		move.w     54(a7),d0
		beq.s      Adr_drag_99
		movea.l    ACSblk,a0
		cmpi.w     #$0008,582(a0)
		ble.s      Adr_drag_99
		subq.w     #1,54(a7)
Adr_drag_99:
		move.w     54(a7),d0
		beq.s      Adr_drag_100
		movea.l    ACSblk,a0
		cmpi.w     #$0014,582(a0)
		ble.s      Adr_drag_100
		subq.w     #1,54(a7)
Adr_drag_100:
		clr.w      76(a7)
		bra.s      Adr_drag_101
Adr_drag_104:
		clr.w      d0
		move.w     d0,90(a7)
		move.w     d0,92(a7)
		moveq.l    #1,d0
		move.b     55(a7),d1
		lsl.w      d1,d0
		move.w     d0,78(a7)
		bra.s      Adr_drag_102
Adr_drag_103:
		move.w     84(a7),d0
		add.w      d0,92(a7)
		move.w     82(a7),d0
		add.w      d0,90(a7)
		move.w     82(a7),d1
		move.w     90(a7),d0
		move.b     55(a7),d2
		asr.w      d2,d0
		sub.w      d0,d1
		move.w     84(a7),d0
		move.w     92(a7),d2
		move.b     55(a7),d3
		asr.w      d3,d2
		sub.w      d2,d0
		bsr        drag_draw
		subq.w     #1,78(a7)
Adr_drag_102:
		move.w     78(a7),d0
		bgt.s      Adr_drag_103
Adr_drag_101:
		move.w     76(a7),d0
		addq.w     #1,76(a7)
		subq.w     #2,d0
		blt.s      Adr_drag_104
Adr_drag_3:
		lea.l      546(a7),a7
		movea.l    (a7)+,a2
		move.w     (a7)+,d3
		rts

	.data

xe05f6:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
xe06f6:
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000
		dc.w $0000

xe0706:
		dc.b 'U:\PIPE\DRAGDROP.AA',0
xe071a:
		dc.w $7c00
xe071c:
		dc.b 'U:\PIPE',0
xe0724:
		dc.b '.TXT    ',0
		dc.b $00
		dc.b 0
xe072f:
		dc.b 'ARGS    ',0
		dc.w $0000
		.even

	.bss

pattern: ds.w 1
drags: ds.b 8192
