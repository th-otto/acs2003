
	.globl A_pattern
A_pattern:
		move.l     d2,-(a7)
		lea.l      -14(a7),a7
		movea.l    22(a7),a0
		move.w     22(a0),d0
		bne.s      A_pattern_1
		movea.l    22(a7),a0
		move.w     24(a0),d0
		beq.s      A_pattern_2
A_pattern_1:
		movea.l    22(a7),a0
		move.w     18(a0),6(a7)
		movea.l    22(a7),a0
		move.w     20(a0),8(a7)
		movea.l    22(a7),a0
		move.w     18(a0),d0
		movea.l    22(a7),a0
		add.w      22(a0),d0
		subq.w     #1,d0
		move.w     d0,10(a7)
		movea.l    22(a7),a0
		move.w     20(a0),d0
		movea.l    22(a7),a0
		add.w      24(a0),d0
		subq.w     #1,d0
		move.w     d0,12(a7)
		lea.l      6(a7),a0
		moveq.l    #1,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		bra.s      A_pattern_3
A_pattern_2:
		lea.l      6(a7),a0
		clr.w      d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
A_pattern_3:
		movea.l    22(a7),a0
		move.w     10(a0),6(a7)
		movea.l    22(a7),a0
		move.w     12(a0),8(a7)
		move.w     6(a7),d0
		movea.l    22(a7),a0
		add.w      14(a0),d0
		subq.w     #1,d0
		move.w     d0,10(a7)
		move.w     8(a7),d0
		movea.l    22(a7),a0
		add.w      16(a0),d0
		subq.w     #1,d0
		move.w     d0,12(a7)
		movea.l    22(a7),a0
		move.l     26(a0),(a7)
		movea.l    22(a7),a0
		move.w     6(a0),d0
		movea.l    22(a7),a0
		move.w     8(a0),d1
		eor.w      d1,d0
		move.w     d0,4(a7)
		move.w     4(a7),d0
		bne        A_pattern_4
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
		move.w     (a7),d0
		lsl.w      #8,d0
		asr.w      #8,d0
		and.w      #$00C0,d0
		tst.w      d0
		beq.s      A_pattern_5
		sub.w      #$0040,d0
		beq.s      A_pattern_6
		bra.s      A_pattern_7
A_pattern_5:
		moveq.l    #3,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_interior
		move.w     (a7),d1
		lsl.w      #8,d1
		asr.w      #8,d1
		and.w      #$001F,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_style
		bra.s      A_pattern_8
A_pattern_6:
		moveq.l    #2,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_interior
		move.w     (a7),d1
		lsl.w      #8,d1
		asr.w      #8,d1
		and.w      #$001F,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_style
		bra.s      A_pattern_8
A_pattern_7:
		moveq.l    #4,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_interior
		moveq.l    #1,d1
		move.w     (a7),d0
		lsl.w      #8,d0
		asr.w      #8,d0
		and.w      #$001F,d0
		lsl.w      #2,d0
		lea.l      up,a0
		movea.l    0(a0,d0.w),a0
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vsf_udpat
A_pattern_8:
		moveq.l    #15,d1
		and.w      2(a7),d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_color
		move.w     (a7),d0
		lsl.w      #8,d0
		asr.w      #8,d0
		and.w      #$0020,d0
		beq.s      A_pattern_9
		moveq.l    #1,d1
		bra.s      A_pattern_10
A_pattern_9:
		clr.w      d1
A_pattern_10:
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_perimeter
		lea.l      6(a7),a0
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_bar
A_pattern_4:
		moveq.l    #1,d0
		and.w      4(a7),d0
		bne.s      A_pattern_11
		moveq.l    #1,d0
		movea.l    22(a7),a0
		and.w      8(a0),d0
		beq.s      A_pattern_12
A_pattern_11:
		moveq.l    #3,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_interior
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_color
		clr.w      d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_perimeter
		lea.l      6(a7),a0
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_bar
A_pattern_12:
		lea.l      6(a7),a0
		clr.w      d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		moveq.l    #-2,d0
		movea.l    22(a7),a0
		and.w      8(a0),d0
		lea.l      14(a7),a7
		move.l     (a7)+,d2
		rts

	.globl A_arrows
A_arrows:
		move.l     d2,-(a7)
		lea.l      -24(a7),a7
		movea.l    32(a7),a0
		move.w     22(a0),d0
		bne.s      A_arrows_1
		movea.l    32(a7),a0
		move.w     24(a0),d0
		beq.s      A_arrows_2
A_arrows_1:
		movea.l    32(a7),a0
		move.w     18(a0),16(a7)
		movea.l    32(a7),a0
		move.w     20(a0),18(a7)
		movea.l    32(a7),a0
		move.w     18(a0),d0
		movea.l    32(a7),a0
		add.w      22(a0),d0
		subq.w     #1,d0
		move.w     d0,20(a7)
		movea.l    32(a7),a0
		move.w     20(a0),d0
		movea.l    32(a7),a0
		add.w      24(a0),d0
		subq.w     #1,d0
		move.w     d0,22(a7)
		lea.l      16(a7),a0
		moveq.l    #1,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		bra.s      A_arrows_3
A_arrows_2:
		lea.l      16(a7),a0
		clr.w      d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
A_arrows_3:
		movea.l    32(a7),a0
		lea.l      26(a0),a0
		move.l     a0,10(a7)
		movea.l    10(a7),a0
		move.l     (a0),d0
		moveq.l    #19,d1
		asr.l      d1,d0
		and.l      #$00000001,d0
		beq.s      A_arrows_4
		move.w     #$0001,(a7)
		bra.s      A_arrows_5
A_arrows_4:
		clr.w      (a7)
A_arrows_5:
		movea.l    32(a7),a0
		move.w     6(a0),d0
		movea.l    32(a7),a0
		cmp.w      8(a0),d0
		bne        A_arrows_6
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
		movea.l    32(a7),a0
		move.w     14(a0),d0
		asr.w      #1,d0
		move.w     d0,6(a7)
		movea.l    32(a7),a0
		move.w     16(a0),d0
		asr.w      #1,d0
		move.w     d0,8(a7)
		movea.l    ACSblk,a0
		move.w     18(a0),d0
		asr.w      #1,d0
		move.w     d0,2(a7)
		movea.l    ACSblk,a0
		move.w     20(a0),d0
		asr.w      #1,d0
		move.w     d0,4(a7)
		movea.l    32(a7),a0
		move.w     10(a0),d0
		move.w     d0,20(a7)
		move.w     d0,16(a7)
		movea.l    32(a7),a0
		move.w     12(a0),d0
		move.w     d0,22(a7)
		move.w     d0,18(a7)
		movea.l    10(a7),a0
		move.l     (a0),d0
		moveq.l    #24,d1
		asr.l      d1,d0
		and.w      #$0007,d0
		cmp.w      #$0007,d0
		bhi        A_arrows_7
		add.w      d0,d0
		move.w     J49(pc,d0.w),d0
		jmp        J49(pc,d0.w)
J49:
		dc.w A_arrows_8-J49
		dc.w A_arrows_9-J49
		dc.w A_arrows_10-J49
		dc.w A_arrows_11-J49
		dc.w A_arrows_12-J49
		dc.w A_arrows_13-J49
		dc.w A_arrows_14-J49
		dc.w A_arrows_15-J49
A_arrows_8:
		move.w     6(a7),d0
		add.w      d0,16(a7)
		move.w     (a7),d0
		add.w      d0,18(a7)
		bra        A_arrows_7
A_arrows_9:
		move.w     (a7),d0
		add.w      d0,16(a7)
		move.w     (a7),d0
		add.w      d0,18(a7)
		bra.w      A_arrows_7
A_arrows_10:
		move.w     (a7),d0
		add.w      d0,16(a7)
		move.w     8(a7),d0
		add.w      d0,18(a7)
		bra.s      A_arrows_7
A_arrows_11:
		move.w     (a7),d0
		add.w      d0,16(a7)
		moveq.l    #-1,d0
		movea.l    32(a7),a0
		add.w      16(a0),d0
		sub.w      (a7),d0
		add.w      d0,18(a7)
		bra.s      A_arrows_7
A_arrows_12:
		move.w     4(a7),d0
		add.w      d0,18(a7)
		move.w     6(a7),d0
		add.w      d0,16(a7)
		bra.s      A_arrows_7
A_arrows_13:
		move.w     2(a7),d0
		add.w      d0,16(a7)
		move.w     4(a7),d0
		add.w      d0,18(a7)
		bra.s      A_arrows_7
A_arrows_14:
		move.w     2(a7),d0
		add.w      d0,16(a7)
		move.w     8(a7),d0
		add.w      d0,18(a7)
		bra.s      A_arrows_7
A_arrows_15:
		move.w     2(a7),d0
		add.w      d0,16(a7)
		movea.l    32(a7),a0
		move.w     16(a0),d0
		sub.w      4(a7),d0
		add.w      d0,18(a7)
		nop
A_arrows_7:
		movea.l    10(a7),a0
		move.l     (a0),d0
		moveq.l    #28,d1
		asr.l      d1,d0
		and.w      #$0007,d0
		cmp.w      #$0007,d0
		bhi        A_arrows_16
		add.w      d0,d0
		move.w     J50(pc,d0.w),d0
		jmp        J50(pc,d0.w)
J50:
		dc.w A_arrows_17-J50
		dc.w A_arrows_18-J50
		dc.w A_arrows_19-J50
		dc.w A_arrows_20-J50
		dc.w A_arrows_21-J50
		dc.w A_arrows_22-J50
		dc.w A_arrows_23-J50
		dc.w A_arrows_24-J50
A_arrows_17:
		move.w     6(a7),d0
		add.w      d0,20(a7)
		moveq.l    #-1,d0
		movea.l    32(a7),a0
		add.w      16(a0),d0
		sub.w      (a7),d0
		add.w      d0,22(a7)
		bra        A_arrows_16
A_arrows_18:
		moveq.l    #-1,d0
		movea.l    32(a7),a0
		add.w      14(a0),d0
		sub.w      (a7),d0
		add.w      d0,20(a7)
		moveq.l    #-1,d0
		movea.l    32(a7),a0
		add.w      16(a0),d0
		sub.w      (a7),d0
		add.w      d0,22(a7)
		bra        A_arrows_16
A_arrows_19:
		moveq.l    #-1,d0
		movea.l    32(a7),a0
		add.w      14(a0),d0
		sub.w      (a7),d0
		add.w      d0,20(a7)
		move.w     8(a7),d0
		add.w      d0,22(a7)
		bra        A_arrows_16
A_arrows_20:
		moveq.l    #-1,d0
		movea.l    32(a7),a0
		add.w      14(a0),d0
		sub.w      (a7),d0
		add.w      d0,20(a7)
		move.w     (a7),d0
		add.w      d0,22(a7)
		bra.s      A_arrows_16
A_arrows_21:
		move.w     6(a7),d0
		add.w      d0,20(a7)
		movea.l    32(a7),a0
		move.w     16(a0),d0
		sub.w      4(a7),d0
		add.w      d0,22(a7)
		bra.s      A_arrows_16
A_arrows_22:
		movea.l    32(a7),a0
		move.w     14(a0),d0
		sub.w      2(a7),d0
		add.w      d0,20(a7)
		movea.l    32(a7),a0
		move.w     16(a0),d0
		sub.w      4(a7),d0
		add.w      d0,22(a7)
		bra.s      A_arrows_16
A_arrows_23:
		movea.l    32(a7),a0
		move.w     14(a0),d0
		sub.w      2(a7),d0
		add.w      d0,20(a7)
		move.w     8(a7),d0
		add.w      d0,22(a7)
		bra.s      A_arrows_16
A_arrows_24:
		movea.l    32(a7),a0
		move.w     14(a0),d0
		sub.w      2(a7),d0
		add.w      d0,20(a7)
		move.w     4(a7),d0
		add.w      d0,22(a7)
		nop
A_arrows_16:
		move.w     (a7),d0
		beq.s      A_arrows_25
		moveq.l    #3,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_width
		bra.s      A_arrows_26
A_arrows_25:
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_width
A_arrows_26:
		movea.l    10(a7),a0
		move.l     (a0),d0
		moveq.l    #16,d1
		asr.l      d1,d0
		and.w      #$0007,d0
		move.w     d0,14(a7)
		cmpi.w     #$0007,14(a7)
		bne.s      A_arrows_27
		move.w     #$5555,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_udsty
A_arrows_27:
		move.w     14(a7),d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_type
		movea.l    10(a7),a0
		move.l     (a0),d2
		moveq.l    #22,d0
		asr.l      d0,d2
		and.w      #$0003,d2
		movea.l    10(a7),a0
		move.l     (a0),d1
		moveq.l    #20,d0
		asr.l      d0,d1
		and.w      #$0003,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_ends
		movea.l    10(a7),a0
		move.l     (a0),d0
		and.l      #$80000000,d0
		beq.s      A_arrows_28
		movea.l    ACSblk,a0
		movea.l    572(a0),a0
		move.w     14(a0),d0
		and.w      #$0100,d0
		bne.s      A_arrows_28
		addq.w     #1,16(a7)
		addq.w     #1,20(a7)
		addq.w     #1,18(a7)
		addq.w     #1,22(a7)
		clr.w      d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_color
		lea.l      16(a7),a0
		moveq.l    #2,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_pline
		subq.w     #1,16(a7)
		subq.w     #1,20(a7)
		subq.w     #1,18(a7)
		subq.w     #1,22(a7)
A_arrows_28:
		moveq.l    #15,d1
		movea.l    10(a7),a0
		and.w      2(a0),d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_color
		lea.l      16(a7),a0
		moveq.l    #2,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_pline
A_arrows_6:
		moveq.l    #1,d0
		movea.l    32(a7),a0
		and.w      6(a0),d0
		bne.s      A_arrows_29
		moveq.l    #1,d0
		movea.l    32(a7),a0
		and.w      8(a0),d0
		beq        A_arrows_30
A_arrows_29:
		moveq.l    #1,d0
		movea.l    32(a7),a0
		add.w      18(a0),d0
		move.w     d0,16(a7)
		moveq.l    #1,d0
		movea.l    32(a7),a0
		add.w      20(a0),d0
		move.w     d0,18(a7)
		movea.l    32(a7),a0
		move.w     18(a0),d0
		movea.l    32(a7),a0
		add.w      22(a0),d0
		subq.w     #2,d0
		move.w     d0,20(a7)
		movea.l    32(a7),a0
		move.w     20(a0),d0
		movea.l    32(a7),a0
		add.w      24(a0),d0
		subq.w     #2,d0
		move.w     d0,22(a7)
		lea.l      16(a7),a0
		moveq.l    #1,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		moveq.l    #3,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_interior
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_color
		clr.w      d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsf_perimeter
		lea.l      16(a7),a0
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_bar
A_arrows_30:
		clr.w      d2
		clr.w      d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_ends
		lea.l      16(a7),a0
		clr.w      d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		move.w     (a7),d0
		ble.s      A_arrows_31
		moveq.l    #-2,d0
		movea.l    32(a7),a0
		and.w      8(a0),d0
		bra.s      A_arrows_32
		bra.s      A_arrows_32
A_arrows_31:
		moveq.l    #-10,d0
		movea.l    32(a7),a0
		and.w      8(a0),d0
		nop
A_arrows_32:
		lea.l      24(a7),a7
		move.l     (a7)+,d2
		rts

	.globl A_select
A_select:
		move.l     d2,-(a7)
		lea.l      -30(a7),a7
		movea.l    38(a7),a0
		move.w     22(a0),d0
		bne.s      A_select_1
		movea.l    38(a7),a0
		move.w     24(a0),d0
		beq.s      A_select_2
A_select_1:
		movea.l    38(a7),a0
		move.w     18(a0),22(a7)
		movea.l    38(a7),a0
		move.w     20(a0),24(a7)
		movea.l    38(a7),a0
		move.w     18(a0),d0
		movea.l    38(a7),a0
		add.w      22(a0),d0
		subq.w     #1,d0
		move.w     d0,26(a7)
		movea.l    38(a7),a0
		move.w     20(a0),d0
		movea.l    38(a7),a0
		add.w      24(a0),d0
		subq.w     #1,d0
		move.w     d0,28(a7)
		lea.l      22(a7),a0
		moveq.l    #1,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		bra.s      A_select_3
A_select_2:
		lea.l      22(a7),a0
		clr.w      d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
A_select_3:
		movea.l    38(a7),a0
		move.w     6(a0),d0
		movea.l    38(a7),a0
		move.w     8(a0),d1
		eor.w      d1,d0
		move.w     d0,(a7)
		move.w     (a7),d0
		bne.s      A_select_4
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
		bra.s      A_select_5
A_select_4:
		moveq.l    #3,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vswr_mode
A_select_5:
		moveq.l    #1,d0
		movea.l    38(a7),a0
		and.w      6(a0),d0
		bne.s      A_select_6
		moveq.l    #1,d0
		movea.l    38(a7),a0
		and.w      8(a0),d0
		beq        A_select_7
A_select_6:
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_width
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_color
		clr.w      d2
		clr.w      d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_ends
		moveq.l    #1,d1
		movea.l    ACSblk,a0
		move.w     16(a0),d0
		jsr        vsl_type
		movea.l    38(a7),a0
		move.w     10(a0),d0
		move.w     d0,18(a7)
		move.w     d0,14(a7)
		move.w     d0,2(a7)
		movea.l    38(a7),a0
		move.w     12(a0),d0
		move.w     d0,20(a7)
		move.w     d0,8(a7)
		move.w     d0,4(a7)
		movea.l    38(a7),a0
		move.w     10(a0),d0
		movea.l    38(a7),a0
		add.w      14(a0),d0
		subq.w     #1,d0
		move.w     d0,10(a7)
		move.w     d0,6(a7)
		movea.l    38(a7),a0
		move.w     12(a0),d0
		movea.l    38(a7),a0
		add.w      16(a0),d0
		subq.w     #1,d0
		move.w     d0,16(a7)
		move.w     d0,12(a7)
		lea.l      2(a7),a0
		moveq.l    #5,d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        v_pline
A_select_7:
		lea.l      22(a7),a0
		clr.w      d1
		movea.l    ACSblk,a1
		move.w     16(a1),d0
		jsr        vs_clip
		moveq.l    #-2,d0
		movea.l    38(a7),a0
		and.w      8(a0),d0
		lea.l      30(a7),a7
		move.l     (a7)+,d2
		rts

	.data

quer:
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $ffff
quer2:
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $0000
		dc.w $0000
quer3:
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $ffff
		dc.w $0000
		dc.w $0000
		dc.w $ffff
		dc.w $ffff
senk:
		dc.b 'UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD33333333333333333333333333333333'

up:
		dc.l quer
		dc.l quer
		dc.l quer2
		dc.l quer3
		dc.l senk
		dc.l senk2
		dc.l senk3
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
		dc.l quer
